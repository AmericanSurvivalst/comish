<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L99MVF0SXV"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-L99MVF0SXV');
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comish | Know Your Paycheck Before It Hits</title>
    <meta name="description" content="Commission tracking for sales reps. See your exact commission on every deal, at every tier, in real time. Stop guessing what you're getting paid.">
    <meta name="keywords" content="commission tracker, sales commission calculator, commission tracking software, sales rep tools, tiered commission calculator">
    <meta name="author" content="Comish">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://comish.online/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://comish.online/">
    <meta property="og:title" content="Comish | Know Your Paycheck Before It Hits">
    <meta property="og:description" content="Commission tracking for sales reps. See your exact commission on every deal, at every tier, in real time.">
    <meta property="og:image" content="https://comish.online/og-image.png">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://comish.online/">
    <meta name="twitter:title" content="Comish | Know Your Paycheck Before It Hits">
    <meta name="twitter:description" content="Commission tracking for sales reps. See your exact commission on every deal, at every tier, in real time.">
    <meta name="twitter:image" content="https://comish.online/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#00ff88">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Comish">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Comish",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "description": "Commission tracking for sales reps. See your exact commission on every deal, at every tier, in real time.",
      "offers": {
        "@type": "Offer",
        "price": "5.00",
        "priceCurrency": "USD",
        "priceValidUntil": "2026-12-31"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "127"
      }
    }
    </script>
    <style>
:root{--bg:#000;--bg2:#0a0a0a;--card:#0d0d0d;--card2:#161616;--border:#262626;--text:#fff;--text2:#a3a3a3;--muted:#666;--accent:#00ff88;--accent2:#00cc6a;--glow:rgba(0,255,136,0.12);--blue:#3b82f6;--purple:#a855f7;--pink:#ec4899;--orange:#f97316;--yellow:#facc15}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Inter',-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;overflow-x:hidden;background-image:radial-gradient(rgba(255,255,255,0.03) 1px,transparent 1px);background-size:40px 40px}
a{color:inherit;text-decoration:none}
.gradient-bg{position:fixed;inset:0;background:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(0,255,136,0.15),transparent),radial-gradient(ellipse 60% 40% at 100% 0%,rgba(59,130,246,0.1),transparent);pointer-events:none;z-index:0}
.glow-1{position:absolute;width:600px;height:600px;background:radial-gradient(circle,rgba(0,255,136,0.12),transparent 70%);border-radius:50%;pointer-events:none;z-index:0}
.glow-2{position:absolute;width:500px;height:500px;background:radial-gradient(circle,rgba(59,130,246,0.1),transparent 70%);border-radius:50%;pointer-events:none;z-index:0}
.glow-3{position:absolute;width:400px;height:400px;background:radial-gradient(circle,rgba(168,85,247,0.1),transparent 70%);border-radius:50%;pointer-events:none;z-index:0}
nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:1rem 2rem;background:rgba(0,0,0,0.8);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,0.05)}
nav .container{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
.logo{font-size:1.5rem;font-weight:900;letter-spacing:-0.03em}
.logo span{color:var(--accent)}
nav .links{display:flex;gap:2.5rem;align-items:center}
nav .links a{color:var(--text2);font-size:0.9rem;font-weight:500;transition:color 0.2s}
nav .links a:hover{color:var(--text)}
.mobile-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
.mobile-close{display:none;position:absolute;top:1rem;right:1rem;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
@media(max-width:768px){
nav .links{position:fixed;top:0;right:-100%;width:280px;height:100vh;background:var(--card);flex-direction:column;justify-content:flex-start;padding:5rem 2rem 2rem;gap:1.5rem;transition:right 0.3s;border-left:1px solid var(--border)}
nav .links.open{right:0}
nav .links a{font-size:1.1rem}
nav .links .btn{width:100%}
.mobile-toggle{display:block}
.mobile-close{display:block}
}
.btn{display:inline-flex;align-items:center;justify-content:center;padding:0.875rem 1.75rem;border-radius:100px;font-weight:600;font-size:0.95rem;cursor:pointer;border:none;transition:all 0.3s;font-family:inherit}
.btn-primary{background:var(--accent);color:#000;box-shadow:0 0 30px rgba(0,255,136,0.3)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 0 50px rgba(0,255,136,0.5)}
.btn-secondary{background:rgba(255,255,255,0.05);color:var(--text);border:1px solid rgba(255,255,255,0.1)}
.btn-secondary:hover{background:rgba(255,255,255,0.1)}
.btn-ghost{background:transparent;color:var(--text2);padding:0.5rem 1rem}
.btn-ghost:hover{color:var(--text)}
.btn-lg{padding:1.125rem 2.5rem;font-size:1rem}
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:8rem 2rem 4rem;position:relative;z-index:1}
.hero-content{max-width:900px;text-align:center}
.hero-badge{display:inline-flex;align-items:center;gap:0.5rem;background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.2);color:var(--accent);padding:0.625rem 1.25rem;border-radius:100px;font-size:0.875rem;font-weight:600;margin-bottom:2rem;animation:pulse 3s ease-in-out infinite}
@keyframes pulse{0%,100%{box-shadow:0 0 20px rgba(0,255,136,0.2)}50%{box-shadow:0 0 40px rgba(0,255,136,0.4)}}
.hero h1{font-size:clamp(3rem,8vw,5.5rem);font-weight:900;line-height:1.05;letter-spacing:-0.03em;margin-bottom:1.5rem}
.hero h1 .gradient{background:linear-gradient(135deg,var(--accent) 0%,#00ffcc 50%,var(--blue) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero-sub{font-size:1.35rem;color:var(--text2);margin-bottom:2.5rem;max-width:650px;margin-left:auto;margin-right:auto;line-height:1.7}
.hero-buttons{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-bottom:3rem}
.social-proof{display:flex;align-items:center;justify-content:center;gap:1rem}
.proof-avatars{display:flex}
.avatar{width:40px;height:40px;border:2px solid var(--bg);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.85rem;font-weight:700;margin-left:-12px;color:#fff}
.avatar:first-child{margin-left:0}
.avatar:nth-child(1){background:linear-gradient(135deg,#3b82f6,#1d4ed8)}
.avatar:nth-child(2){background:linear-gradient(135deg,#a855f7,#7c3aed)}
.avatar:nth-child(3){background:linear-gradient(135deg,#ec4899,#db2777)}
.avatar:nth-child(4){background:linear-gradient(135deg,#f97316,#ea580c)}
.social-proof p{color:var(--text2);font-size:0.95rem}
.social-proof strong{color:var(--text)}
.section{padding:8rem 2rem;position:relative;z-index:1;overflow:hidden}
.section::before{content:'';position:absolute;inset:0;background:linear-gradient(180deg,transparent,rgba(0,0,0,0.3),transparent);pointer-events:none}
.section:nth-child(odd){background:linear-gradient(180deg,var(--bg),var(--bg2),var(--bg))}
.section:nth-child(even){background:var(--bg)}
.section .container{max-width:1100px;margin:0 auto}
.section-label{text-align:center;color:var(--accent);font-size:0.85rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:1rem}
.section-title{text-align:center;font-size:clamp(2rem,5vw,3rem);font-weight:800;letter-spacing:-0.02em;margin-bottom:1rem}
.section-sub{text-align:center;color:var(--text2);font-size:1.2rem;margin-bottom:4rem}
.demo-window{background:var(--card);border:1px solid var(--border);border-radius:20px;overflow:hidden;box-shadow:0 20px 50px -10px rgba(0,0,0,0.5),0 0 100px rgba(0,255,136,0.1)}
.demo-header{background:linear-gradient(180deg,var(--card2),var(--card));padding:1rem 1.5rem;display:flex;align-items:center;gap:1rem;border-bottom:1px solid var(--border)}
.demo-dots{display:flex;gap:8px}
.demo-dots span{width:14px;height:14px;border-radius:50%}
.demo-dots span:nth-child(1){background:#ff5f57}
.demo-dots span:nth-child(2){background:#febc2e}
.demo-dots span:nth-child(3){background:#28c840}
.demo-content{padding:2rem}
.demo-grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem}
@media(max-width:768px){.demo-grid{grid-template-columns:1fr}}
.demo-hero-stat{background:linear-gradient(135deg,rgba(0,255,136,0.1),rgba(0,255,136,0.02));border:1px solid rgba(0,255,136,0.2);border-radius:16px;padding:1.5rem;text-align:center;margin-bottom:1.5rem}
.demo-hero-stat .label{color:var(--accent);font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em}
.demo-hero-stat .value{font-size:clamp(2rem,5vw,3rem);font-weight:900;color:var(--accent);text-shadow:0 0 40px rgba(0,255,136,0.5)}
.demo-hero-stat .sub{color:var(--text2);font-size:0.9rem}
.demo-stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
@media(max-width:500px){.demo-stats-row{grid-template-columns:1fr}}
.demo-stat{background:var(--card2);border:1px solid var(--border);border-radius:12px;padding:1rem;text-align:center}
.demo-stat .label{color:var(--muted);font-size:0.7rem;text-transform:uppercase}
.demo-stat .value{font-size:1.25rem;font-weight:700;margin-top:0.25rem}
.demo-stat .value.green{color:var(--accent)}.demo-stat .value.yellow{color:var(--yellow)}.demo-stat .value.blue{color:var(--blue)}
.demo-tiers{display:flex;flex-direction:column;gap:0.5rem}
.demo-tier{display:flex;align-items:center;padding:0.875rem 1rem;background:var(--card2);border:1px solid var(--border);border-radius:10px}
.demo-tier.active{background:rgba(0,255,136,0.08);border-color:rgba(0,255,136,0.3)}
.demo-tier.active .tier-comm{color:var(--accent)}
.tier-dot{width:10px;height:10px;border-radius:4px;margin-right:0.875rem;flex-shrink:0}
.tier-dot.t1{background:var(--blue)}.tier-dot.t2{background:var(--purple)}.tier-dot.t3{background:var(--pink)}.tier-dot.t4{background:var(--orange)}
.tier-info{flex:1;min-width:0}
.tier-name{font-weight:600;font-size:0.85rem}
.tier-range{font-size:0.75rem;color:var(--muted)}
.tier-comm{font-size:0.95rem;font-weight:700;color:var(--text2);flex-shrink:0}
.pain-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem}
@media(max-width:768px){.pain-grid{grid-template-columns:1fr}}
.pain-card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:2rem;text-align:center;transition:all 0.3s}
.pain-card:hover{border-color:var(--border);transform:translateY(-4px)}
.pain-icon{font-size:3rem;margin-bottom:1rem}
.pain-card p{color:var(--text2);font-size:1.05rem;line-height:1.6}
.features-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem}
@media(max-width:900px){.features-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.features-grid{grid-template-columns:1fr}}
.feature-card{background:linear-gradient(180deg,var(--card2),var(--card));border:1px solid var(--border);border-radius:20px;padding:2rem;transition:all 0.3s}
.feature-card:hover{border-color:var(--accent);transform:translateY(-4px);box-shadow:0 20px 40px -20px rgba(0,255,136,0.2)}
.feature-icon{width:56px;height:56px;background:var(--glow);border:1px solid rgba(0,255,136,0.2);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.25rem}
.feature-card h3{font-size:1.2rem;font-weight:700;margin-bottom:0.5rem}
.feature-card p{color:var(--text2);font-size:0.95rem;line-height:1.6}
.steps{display:flex;flex-direction:column;gap:2rem}
.step{display:flex;gap:2rem;align-items:flex-start;background:var(--card);border:1px solid var(--border);border-radius:20px;padding:2rem;transition:all 0.3s}
.step:hover{border-color:var(--accent)}
.step-num{width:56px;height:56px;background:var(--accent);color:#000;border-radius:16px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.5rem;flex-shrink:0}
.step-content h3{font-size:1.25rem;font-weight:700;margin-bottom:0.5rem}
.step-content p{color:var(--text2);font-size:1rem;line-height:1.6}
@media(max-width:600px){.step{flex-direction:column;align-items:center;text-align:center}}
.story-section{background:linear-gradient(180deg,var(--bg2),var(--bg));position:relative;overflow:hidden}
.story-section::before{content:'';position:absolute;inset:0;background-image:linear-gradient(rgba(0,255,136,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,136,0.03) 1px,transparent 1px);background-size:60px 60px;pointer-events:none}
.story-content{max-width:700px;margin:0 auto;text-align:center}
.story-content p{color:var(--text2);font-size:1.1rem;line-height:1.8;margin-bottom:1.5rem}
.story-content .signature{color:var(--text);font-weight:600;margin-top:2rem}
.faq-grid{display:grid;gap:1rem;max-width:800px;margin:0 auto}
.faq-item{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden}
.faq-q{padding:1.5rem;cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:600;font-size:1.05rem}
.faq-q:hover{background:var(--card2)}
.faq-q span{transition:transform 0.3s}
.faq-item.open .faq-q span{transform:rotate(45deg)}
.faq-a{max-height:0;overflow:hidden;transition:max-height 0.3s,padding 0.3s}
.faq-item.open .faq-a{max-height:500px;padding:0 1.5rem 1.5rem}
.faq-a p{color:var(--text2);line-height:1.7}
.pricing-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:2rem;max-width:900px;margin:0 auto}
@media(max-width:700px){.pricing-grid{grid-template-columns:1fr}}
.price-card{background:var(--card);border:1px solid var(--border);border-radius:24px;padding:2.5rem;position:relative}
.price-card.featured{border-color:var(--accent);box-shadow:0 0 60px rgba(0,255,136,0.15)}
.price-badge{position:absolute;top:-14px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,var(--accent),var(--blue));color:#000;padding:0.5rem 1.25rem;border-radius:100px;font-size:0.8rem;font-weight:700}
.price-name{font-size:1.25rem;font-weight:600;margin-bottom:1rem;color:var(--text2)}
.price-amount{font-size:4rem;font-weight:900;letter-spacing:-0.03em;line-height:1}
.price-amount span{font-size:1.25rem;color:var(--muted);font-weight:500}
.price-period{color:var(--muted);font-size:0.9rem;margin-bottom:2rem}
.price-features{margin:0 0 2rem 0;padding:0;list-style:none}
.price-features li{display:flex;align-items:center;gap:0.875rem;padding:0.625rem 0;color:var(--text2);font-size:0.95rem}
.price-features li::before{content:'‚úì';color:var(--accent);font-weight:700}
.price-card .btn{width:100%}
.cta-section{padding:10rem 2rem;position:relative;z-index:1;text-align:center}
.cta-section::before{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:600px;height:600px;background:radial-gradient(circle,rgba(0,255,136,0.15),transparent 70%);pointer-events:none}
.cta-content{max-width:700px;margin:0 auto;position:relative}
.cta-content h2{font-size:clamp(2.5rem,5vw,3.5rem);font-weight:900;letter-spacing:-0.03em;margin-bottom:1.5rem;line-height:1.1}
.cta-content p{color:var(--text2);font-size:1.25rem;margin-bottom:2.5rem}
.cta-note{margin-top:1.5rem;color:var(--muted);font-size:0.9rem}
footer{padding:4rem 2rem 2rem;border-top:1px solid var(--border);position:relative;z-index:1}
.footer-content{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:2fr 1fr 1fr;gap:3rem}
@media(max-width:768px){.footer-content{grid-template-columns:1fr;text-align:center}}
.footer-brand .logo{margin-bottom:1rem}
.footer-brand p{color:var(--muted);font-size:0.9rem;max-width:300px}
@media(max-width:768px){.footer-brand p{max-width:100%}}
.footer-links h4{font-size:0.85rem;font-weight:600;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:1rem;color:var(--text2)}
.footer-links a{display:block;color:var(--muted);font-size:0.9rem;padding:0.375rem 0;transition:color 0.2s}
.footer-links a:hover{color:var(--text)}
.footer-bottom{max-width:1100px;margin:3rem auto 0;padding-top:2rem;border-top:1px solid var(--border);text-align:center;color:var(--muted);font-size:0.85rem}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);backdrop-filter:blur(10px);z-index:200;align-items:center;justify-content:center;padding:1rem}
.modal-overlay.active{display:flex}
.modal{background:var(--card);border:1px solid var(--border);border-radius:24px;width:100%;max-width:420px;overflow:hidden;box-shadow:0 25px 50px -12px rgba(0,0,0,0.5)}
.modal-header{padding:1.5rem 2rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.modal-header h2{font-size:1.25rem;font-weight:700}
.modal-close{background:none;border:none;color:var(--muted);font-size:1.5rem;cursor:pointer}
.modal-close:hover{color:var(--text)}
.modal-body{padding:2rem}
.form-group{margin-bottom:1.25rem}
.form-label{display:block;font-size:0.9rem;color:var(--text2);margin-bottom:0.5rem;font-weight:500}
.form-input{width:100%;background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:0.875rem 1rem;color:var(--text);font-size:1rem;font-family:inherit}
.form-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,255,136,0.1)}
.form-error{color:#ef4444;font-size:0.85rem;margin-top:0.5rem;display:none}
.form-error.show{display:block}
.auth-switch{text-align:center;margin-top:1.5rem;color:var(--text2);font-size:0.9rem}
.auth-switch a{color:var(--accent);cursor:pointer;font-weight:500}
#app{display:none}
#landing{display:block}
.hidden{display:none!important}
.onboarding{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem;position:relative;z-index:1}
.onboard-card{background:var(--card);border:1px solid var(--border);border-radius:24px;width:100%;max-width:500px;overflow:hidden}
.onboard-header{padding:2rem;border-bottom:1px solid var(--border)}
.onboard-header h2{font-size:1.5rem;font-weight:700;margin-bottom:0.25rem}
.onboard-header p{color:var(--text2)}
.onboard-progress{display:flex;gap:0.5rem;margin-top:1.5rem}
.onboard-progress .step{flex:1;height:4px;background:var(--border);border-radius:2px}
.onboard-progress .step.active,.onboard-progress .step.done{background:var(--accent)}
.onboard-body{padding:2rem}
.onboard-footer{padding:1.5rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:space-between}
.rate-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem}
.rate-grid .form-input{text-align:center;padding:0.75rem 0.5rem}
.rate-label{font-size:0.7rem;color:var(--muted);text-align:center;margin-bottom:0.375rem;text-transform:uppercase}
.dashboard{min-height:100vh;background:var(--bg);position:relative;z-index:1}
.dash-nav{padding:1rem 2rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(0,0,0,0.8);backdrop-filter:blur(20px);position:sticky;top:0;z-index:50}
.user-menu{display:flex;align-items:center;gap:1rem}
.user-email{color:var(--text2);font-size:0.85rem}
@media(max-width:600px){.user-email{display:none}}
.dash-container{max-width:1400px;margin:0 auto;padding:2rem}
@media(max-width:600px){.dash-container{padding:1rem}}
.quick-entry{background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.05));border:1px solid rgba(0,255,136,0.2);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:2rem;flex-wrap:wrap}
.quick-entry label{font-size:0.9rem;color:var(--text2)}
.quick-entry input{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:0.75rem;color:var(--text);font-size:1.25rem;width:180px}
.quick-entry input:focus{outline:none;border-color:var(--accent)}
.quick-entry .hint{font-size:0.75rem;color:var(--muted);margin-top:0.25rem}
.stats{display:grid;grid-template-columns:repeat(5,1fr);gap:1rem;margin-bottom:1.5rem}
@media(max-width:1200px){.stats{grid-template-columns:repeat(3,1fr)}}
@media(max-width:768px){.stats{grid-template-columns:repeat(2,1fr)}}
@media(max-width:480px){.stats{grid-template-columns:1fr}}
.stat{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.25rem}
.stat.hl{border-color:var(--accent);background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.08))}
.stat-label{font-size:0.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.375rem}
.stat-value{font-size:1.375rem;font-weight:700}
.stat-sub{font-size:0.75rem;color:var(--text2);margin-top:0.25rem}
.green{color:var(--accent)}.yellow{color:var(--yellow)}.blue{color:var(--blue)}.purple{color:var(--purple)}
.progress-section{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem}
.progress-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:0.5rem}
.progress-title{font-weight:600}
.progress-stats{display:flex;gap:2rem;font-size:0.9rem;color:var(--text2)}
.progress-stats strong{color:var(--text)}
.progress-bar-wrap{height:24px;background:var(--bg);border-radius:12px;overflow:hidden;margin-bottom:0.75rem}
.progress-bar{height:100%;background:linear-gradient(90deg,var(--blue),var(--purple),var(--pink),var(--orange));border-radius:12px;transition:width 0.5s}
.progress-labels{display:flex;justify-content:space-between;font-size:0.7rem;color:var(--muted)}
.main-grid{display:grid;grid-template-columns:1fr 400px;gap:1.5rem}
@media(max-width:1100px){.main-grid{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden}
.card-header{display:flex;justify-content:space-between;align-items:center;padding:1.25rem 1.5rem;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:0.5rem}
.card-title{font-weight:600}
.table-wrap{max-height:450px;overflow-y:auto}
table{width:100%;border-collapse:collapse}
th{text-align:left;padding:0.75rem 1rem;font-size:0.7rem;color:var(--muted);text-transform:uppercase;border-bottom:1px solid var(--border);position:sticky;top:0;background:var(--card)}
td{padding:0.875rem 1rem;border-bottom:1px solid var(--border);font-size:0.9rem}
tr:hover{background:var(--bg2)}
.badge{display:inline-flex;padding:0.25rem 0.625rem;border-radius:100px;font-size:0.75rem;font-weight:600}
.badge.y1{background:rgba(59,130,246,0.15);color:var(--blue)}
.badge.y2{background:rgba(168,85,247,0.15);color:var(--purple)}
.badge.paid{background:rgba(0,255,136,0.15);color:var(--accent)}
.badge.unpaid{background:rgba(250,204,21,0.15);color:var(--yellow)}
.deal-actions button{background:none;border:none;color:var(--muted);cursor:pointer;padding:0.375rem;font-size:1rem;border-radius:6px}
.deal-actions button:hover{color:var(--text);background:var(--bg2)}
.sidebar-cards{display:flex;flex-direction:column;gap:1.25rem}
.side-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.25rem}
.side-title{font-weight:600;margin-bottom:1rem;padding-bottom:0.75rem;border-bottom:1px solid var(--border)}
.tier-row{display:flex;align-items:center;padding:0.75rem;border-radius:10px;margin-bottom:0.375rem;background:var(--bg)}
.tier-row.active{background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.2)}
.tier-color{width:10px;height:10px;border-radius:4px;margin-right:0.75rem}
.tier-info{flex:1}
.tier-name{font-weight:600;font-size:0.85rem}
.tier-range{font-size:0.75rem;color:var(--muted)}
.tier-amounts{text-align:right}
.tier-rev{font-size:0.75rem;color:var(--text2)}
.tier-comm{font-size:1rem;font-weight:700;color:var(--accent)}
.comm-summary{background:var(--bg);border-radius:12px;padding:1rem;margin-top:1rem}
.comm-row{display:flex;justify-content:space-between;padding:0.375rem 0;font-size:0.9rem}
.comm-row.total{border-top:1px solid var(--border);margin-top:0.75rem;padding-top:0.75rem;font-weight:600}
.comm-row.total .comm-value{color:var(--accent);font-size:1.1rem}
.comm-label{color:var(--text2)}
.comm-value{font-weight:600}
.empty{text-align:center;padding:4rem 2rem;color:var(--muted)}
.view-toggle{display:flex;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:4px;margin-right:auto}
.view-toggle button{padding:0.5rem 1rem;border:none;background:none;color:var(--muted);font-size:0.85rem;font-weight:500;cursor:pointer;border-radius:6px;transition:all 0.2s}
.view-toggle button.active{background:var(--accent);color:#000}
.monthly-section{margin-top:1.5rem}
.monthly-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
.monthly-title{font-weight:600;font-size:1.1rem}
.monthly-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem}
@media(max-width:1200px){.monthly-grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:900px){.monthly-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.monthly-grid{grid-template-columns:1fr}}
.month-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:1.25rem;transition:all 0.2s}
.month-card:hover{border-color:var(--accent)}
.month-card.current{border-color:var(--accent);background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.05))}
.month-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:0.75rem}
.month-name{font-weight:600;font-size:0.95rem}
.month-badge{font-size:0.7rem;padding:0.2rem 0.5rem;border-radius:20px;background:rgba(0,255,136,0.15);color:var(--accent)}
.month-stat{display:flex;justify-content:space-between;padding:0.35rem 0;font-size:0.85rem}
.month-stat-label{color:var(--muted)}
.month-stat-value{font-weight:600}
.chart-section{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-top:1.5rem}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}
.chart-title{font-weight:600}
.chart-legend{display:flex;gap:1.5rem;font-size:0.8rem}
.chart-legend-item{display:flex;align-items:center;gap:0.4rem;color:var(--text2)}
.chart-legend-dot{width:10px;height:10px;border-radius:3px}
.bar-chart{display:flex;align-items:flex-end;justify-content:space-between;height:200px;gap:0.5rem;padding:0 0.5rem}
.bar-group{flex:1;display:flex;flex-direction:column;align-items:center;gap:0.5rem;max-width:80px}
.bar-container{width:100%;height:180px;display:flex;align-items:flex-end;justify-content:center;gap:4px}
.bar{width:45%;border-radius:4px 4px 0 0;transition:height 0.3s;min-height:2px;cursor:pointer;position:relative}
.bar:hover{opacity:0.8}
.bar.revenue{background:linear-gradient(180deg,var(--blue),var(--purple))}
.bar.commission{background:linear-gradient(180deg,var(--accent),var(--accent2))}
.bar-label{font-size:0.7rem;color:var(--muted);text-align:center}
.bar-tooltip{position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:var(--card2);border:1px solid var(--border);border-radius:8px;padding:0.5rem 0.75rem;font-size:0.75rem;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity 0.2s;z-index:10}
.bar:hover .bar-tooltip{opacity:1}
.yearly-summary{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-top:1.5rem}
@media(max-width:900px){.yearly-summary{grid-template-columns:repeat(2,1fr)}}
@media(max-width:500px){.yearly-summary{grid-template-columns:1fr}}
.yearly-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:1.25rem;text-align:center}
.yearly-card.highlight{border-color:var(--accent);background:linear-gradient(135deg,var(--card),rgba(0,255,136,0.08))}
.yearly-card-label{font-size:0.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.5rem}
.yearly-card-value{font-size:1.5rem;font-weight:700}
.yearly-card-sub{font-size:0.8rem;color:var(--text2);margin-top:0.25rem}
.quarter-compare{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-top:1.5rem}
@media(max-width:900px){.quarter-compare{grid-template-columns:repeat(2,1fr)}}
.quarter-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:1.25rem;text-align:center;transition:all 0.2s}
.quarter-card:hover{border-color:var(--border)}
.quarter-card.active{border-color:var(--accent)}
.quarter-name{font-size:0.85rem;color:var(--muted);margin-bottom:0.5rem}
.quarter-revenue{font-size:1.25rem;font-weight:700;margin-bottom:0.25rem}
.quarter-commission{font-size:0.9rem;color:var(--accent)}
.quarter-deals{font-size:0.75rem;color:var(--muted);margin-top:0.5rem}
.profile-page{min-height:100vh;background:var(--bg);position:relative;z-index:1}
.profile-container{max-width:700px;margin:0 auto;padding:2rem}
.profile-header{margin-bottom:2rem}
.profile-header h1{font-size:1.75rem;font-weight:700;margin-bottom:0.25rem}
.profile-header p{color:var(--text2)}
.profile-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem}
.profile-card-title{font-weight:600;margin-bottom:1rem;padding-bottom:0.75rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.profile-row{display:flex;justify-content:space-between;align-items:center;padding:0.75rem 0;border-bottom:1px solid var(--border)}
.profile-row:last-child{border-bottom:none}
.profile-row-label{color:var(--text2);font-size:0.9rem}
.profile-row-value{font-weight:500}
.subscription-badge{display:inline-flex;align-items:center;gap:0.5rem;padding:0.375rem 0.75rem;border-radius:20px;font-size:0.85rem;font-weight:600}
.subscription-badge.trial{background:rgba(250,204,21,0.15);color:var(--yellow)}
.subscription-badge.active{background:rgba(0,255,136,0.15);color:var(--accent)}
.subscription-badge.expired{background:rgba(239,68,68,0.15);color:#ef4444}
.trial-banner{background:linear-gradient(135deg,rgba(250,204,21,0.1),rgba(250,204,21,0.05));border:1px solid rgba(250,204,21,0.3);border-radius:12px;padding:1.25rem;margin-bottom:1.5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
.trial-banner-text{display:flex;align-items:center;gap:0.75rem}
.trial-banner-text span{font-size:1.5rem}
.trial-banner-info strong{display:block;color:var(--yellow)}
.trial-banner-info p{font-size:0.85rem;color:var(--text2)}
.danger-zone{border-color:rgba(239,68,68,0.3)}
.danger-zone .profile-card-title{color:#ef4444}
.btn-danger{background:rgba(239,68,68,0.15);color:#ef4444;border:1px solid rgba(239,68,68,0.3)}
.btn-danger:hover{background:rgba(239,68,68,0.25)}
.trial-expired-modal{position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:9999;display:flex;align-items:center;justify-content:center;padding:2rem}
.trial-expired-content{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:3rem;max-width:450px;text-align:center}
.trial-expired-content h2{font-size:1.75rem;margin-bottom:0.5rem}
.trial-expired-content .subtitle{color:var(--text2);margin-bottom:2rem}
.trial-expired-content .price{font-size:3rem;font-weight:900;color:var(--accent);margin-bottom:0.5rem}
.trial-expired-content .price span{font-size:1rem;font-weight:500;color:var(--text2)}
.trial-expired-content .perks{text-align:left;margin:1.5rem 0;padding:1.5rem;background:var(--card2);border-radius:12px}
.trial-expired-content .perk{display:flex;align-items:center;gap:0.75rem;padding:0.5rem 0;color:var(--text2);font-size:0.95rem}
.trial-expired-content .perk span{color:var(--accent)}
.trial-expired-content .btn{width:100%;margin-top:0.5rem}
.feedback-btn{position:fixed;bottom:2rem;right:2rem;background:var(--card);border:1px solid var(--border);border-radius:50px;padding:0.75rem 1.25rem;font-size:0.85rem;font-weight:600;cursor:pointer;color:var(--text);display:flex;align-items:center;gap:0.5rem;transition:all 0.2s;z-index:50;font-family:inherit}
.feedback-btn:hover{border-color:var(--accent);background:var(--card2)}
.feedback-modal .modal{max-width:500px}
.feedback-type{display:flex;gap:0.5rem;margin-bottom:1rem}
.feedback-type button{flex:1;padding:0.75rem;border:1px solid var(--border);background:var(--card);color:var(--text2);border-radius:8px;cursor:pointer;font-size:0.85rem;transition:all 0.2s;font-family:inherit}
.feedback-type button.active{border-color:var(--accent);background:rgba(0,255,136,0.1);color:var(--accent)}
.feedback-type button:hover{border-color:var(--accent)}
.deal-modal .form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
@media(max-width:500px){.deal-modal .form-row{grid-template-columns:1fr}}
.toggle-group{display:flex;background:var(--bg);border-radius:10px;padding:4px}
.toggle-opt{flex:1;padding:0.625rem;text-align:center;font-size:0.9rem;font-weight:500;cursor:pointer;border-radius:8px;color:var(--muted);transition:all 0.2s}
.toggle-opt.active{background:var(--card2);color:var(--text)}
.toggle-opt.y1.active{color:var(--blue)}
.toggle-opt.y2.active{color:var(--purple)}
.toast-wrap{position:fixed;bottom:2rem;right:2rem;z-index:300}
@media(max-width:600px){.toast-wrap{bottom:1rem;right:1rem;left:1rem}}
.toast{background:var(--card);border:1px solid var(--accent);border-radius:12px;padding:1rem 1.5rem;font-size:0.9rem;box-shadow:0 10px 40px rgba(0,0,0,0.3);animation:slideIn 0.3s}
@keyframes slideIn{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}
</style>
</head>
<body>
<div class="gradient-bg"></div>
<div id="landing">
<nav>
<div class="container">
<div class="logo">Com<span>ish</span></div>
<button class="mobile-toggle" onclick="toggleMobileNav()">‚ò∞</button>
<div class="links" id="navLinks">
<button class="mobile-close" onclick="toggleMobileNav()">‚úï</button>
<a href="#features">Features</a>
<a href="#faq">FAQ</a>
<a href="#pricing">Pricing</a>
<a href="/blog/">Blog</a>
<a href="/affiliates.html">Affiliates</a>
<button class="btn btn-ghost" onclick="showAuth('login');closeMobileNav()">Log in</button>
<button class="btn btn-primary" onclick="showAuth('signup');closeMobileNav()">Start Free</button>
</div>
</div>
</nav>
<section class="hero"><div class="hero-content">
<div class="hero-badge">‚ö° 2 minute setup. 14 days free. No card required.</div>
<h1>Know your paycheck<br><span class="gradient">before it hits.</span></h1>
<p class="hero-sub">Stop waiting until month end to find out what you made. See your exact commission on every deal, at every tier, in real time.</p>
<div class="hero-buttons"><button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Tracking Free</button><button class="btn btn-secondary btn-lg" onclick="document.getElementById('demo').scrollIntoView({behavior:'smooth'})">See It In Action</button></div>
<div class="social-proof"><p>üöÄ Built by a sales rep, for sales reps</p></div>
</div></section>
<section class="section" id="demo"><div class="glow-1" style="top:-200px;right:-200px"></div><div class="glow-2" style="bottom:-150px;left:-150px"></div><div class="container">
<div class="section-label">See It In Action</div>
<h2 class="section-title">Your commission, crystal clear</h2>
<div class="demo-window"><div class="demo-header"><div class="demo-dots"><span></span><span></span><span></span></div><span style="flex:1;text-align:center;color:var(--muted);font-size:0.85rem">comish.app/dashboard</span><div style="width:60px"></div></div>
<div class="demo-content"><div class="demo-grid">
<div><div class="demo-hero-stat"><div class="label">Total Commission This Quarter</div><div class="value">$34,125</div><div class="sub">122% attainment at Tier 3 rates</div></div>
<div class="demo-stats-row"><div class="demo-stat"><div class="label">Revenue</div><div class="value">$456K</div></div><div class="demo-stat"><div class="label">To Tier 4</div><div class="value yellow">$106K</div></div><div class="demo-stat"><div class="label">This Month</div><div class="value blue">$98K</div></div></div></div>
<div><h3 style="font-size:0.9rem;font-weight:600;margin-bottom:1rem;color:var(--text2)">Commission by Tier</h3>
<div class="demo-tiers">
<div class="demo-tier active"><span class="tier-dot t1"></span><div class="tier-info"><div class="tier-name">Tier 1 (6%)</div><div class="tier-range">$0 to $375K</div></div><span class="tier-comm">$22,500</span></div>
<div class="demo-tier active"><span class="tier-dot t2"></span><div class="tier-info"><div class="tier-name">Tier 2 (8%)</div><div class="tier-range">$375K to $469K</div></div><span class="tier-comm">$7,500</span></div>
<div class="demo-tier active"><span class="tier-dot t3"></span><div class="tier-info"><div class="tier-name">Tier 3 (10%)</div><div class="tier-range">$469K to $562K</div></div><span class="tier-comm">$4,125</span></div>
<div class="demo-tier"><span class="tier-dot t4"></span><div class="tier-info"><div class="tier-name">Tier 4 (12%)</div><div class="tier-range">$562K+</div></div><span class="tier-comm">$0</span></div>
</div></div>
</div></div></div>
</div></section>
<section class="section"><div class="container">
<h2 class="section-title">Sound familiar?</h2>
<p class="section-sub">Yeah, we have been there too.</p>
<div class="pain-grid">
<div class="pain-card"><div class="pain-icon">üò§</div><p>"I have no idea what I am actually getting paid until the check hits my account."</p></div>
<div class="pain-card"><div class="pain-icon">ü§Ø</div><p>"My comp plan has so many tiers and accelerators, even finance gets the math wrong."</p></div>
<div class="pain-card"><div class="pain-icon">ü§∑</div><p>"Am I close to the next tier? How much is it worth? No clue."</p></div>
</div></div></section>
<section class="section" id="features"><div class="glow-3" style="top:100px;left:-100px"></div><div class="glow-2" style="bottom:0;right:-200px"></div><div class="container">
<div class="section-label">Features</div>
<h2 class="section-title">Everything you need. Nothing you don't.</h2>
<div class="features-grid" style="margin-top:4rem">
<div class="feature-card"><div class="feature-icon">üíµ</div><h3>Exact dollar amounts</h3><p>Not percentages. Not estimates. The actual cash hitting your account after every deal.</p></div>
<div class="feature-card"><div class="feature-icon">üìä</div><h3>Tier by tier breakdown</h3><p>See exactly how much you earn at each commission tier. No more spreadsheet gymnastics.</p></div>
<div class="feature-card"><div class="feature-icon">üéØ</div><h3>Distance to next tier</h3><p>Know exactly how far you are from the next rate bump and what that bump is worth.</p></div>
<div class="feature-card"><div class="feature-icon">üìù</div><h3>Multi year contracts</h3><p>Different rates for 1 year vs 2 year deals? We calculate them separately, automatically.</p></div>
<div class="feature-card"><div class="feature-icon">‚ö°</div><h3>5 second deal entry</h3><p>Client name, amount, close date. Three fields. Done. Add deals between calls.</p></div>
<div class="feature-card"><div class="feature-icon">üì±</div><h3>Works everywhere</h3><p>Phone, tablet, laptop. Check your commission while you wait for your next meeting.</p></div>
</div></div></section>
<section class="section" style="background:linear-gradient(180deg,var(--bg),var(--bg2))"><div class="container" style="max-width:900px">
<h2 class="section-title">Zero to tracking in 2 minutes</h2>
<div class="steps" style="margin-top:4rem">
<div class="step"><div class="step-num">1</div><div class="step-content"><h3>Plug in your comp plan</h3><p>Quarterly goal, tier thresholds, commission rates. One time setup that takes 60 seconds.</p></div></div>
<div class="step"><div class="step-num">2</div><div class="step-content"><h3>Log your deals</h3><p>Add deals as you close them. Or enter your quarter to date total to get started instantly.</p></div></div>
<div class="step"><div class="step-num">3</div><div class="step-content"><h3>Know your money</h3><p>Watch your commission update in real time. Know exactly what you are taking home.</p></div></div>
</div></div></section>
<section class="section story-section"><div class="container">
<div class="section-label">The Story</div>
<h2 class="section-title">Built by a rep, for reps</h2>
<div class="story-content" style="margin-top:3rem">
<p>I have spent 15+ years in sales. Every single month, the same problem: I had no idea what my actual paycheck would be until it hit my account.</p>
<p>My comp plan was complicated. Tiered rates, different percentages for multi year deals, quarterly accelerators. I tried tracking it in spreadsheets but they always broke. I asked finance and got different answers every time.</p>
<p>So I built Comish. First just for myself. Then for my team. Now for you.</p>
<p>It does one thing really well: it tells you exactly what you are getting paid, broken down by tier, updated after every deal you close.</p>
<p class="signature">Scott, Founder</p>
</div></div></section>
<section class="section" id="faq"><div class="glow-1" style="top:-100px;left:50%;transform:translateX(-50%)"></div><div class="container">
<h2 class="section-title">Questions? Answers.</h2>
<div class="faq-grid" style="margin-top:4rem">
<div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">How does the free trial work?<span>+</span></div><div class="faq-a"><p>You get full access for 14 days, no credit card required. If you love it, subscribe for $5/month. If not, your data is deleted and you owe nothing.</p></div></div>
<div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">Can it handle my complicated comp plan?<span>+</span></div><div class="faq-a"><p>Comish handles tiered commission structures with up to 4 tiers, different rates for 1 year vs 2 year contracts, and quarterly goals. If your plan is more complex than that, reach out and we will see if we can help.</p></div></div>
<div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">Is my commission data secure?<span>+</span></div><div class="faq-a"><p>Yes. Your data is encrypted in transit and at rest. We use Supabase for authentication and database, which provides bank level security. We never share your data with anyone.</p></div></div>
<div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">Can I export my data?<span>+</span></div><div class="faq-a"><p>Yes. You can export all your deals to CSV at any time. Your data is yours.</p></div></div>
<div class="faq-item"><div class="faq-q" onclick="toggleFaq(this)">What if I need help?<span>+</span></div><div class="faq-a"><p>Email info@comish.online and I will personally respond within 48 hours. No support tickets, no chatbots.</p></div></div>
</div></div></section>
<section class="section" id="pricing" style="background:linear-gradient(180deg,var(--bg2),var(--bg))"><div class="glow-2" style="top:50%;left:-200px;transform:translateY(-50%)"></div><div class="glow-3" style="top:50%;right:-150px;transform:translateY(-50%)"></div><div class="container">
<h2 class="section-title">Simple pricing</h2>
<p class="section-sub">No surprises. Just like your commission should be.</p>
<div class="billing-toggle" style="display:flex;justify-content:center;gap:0.5rem;align-items:center;margin-bottom:2rem">
<span id="monthlyLabel" style="font-weight:600;color:var(--accent)">Monthly</span>
<button onclick="toggleBilling()" id="billingToggle" style="width:56px;height:30px;background:var(--card);border:1px solid var(--border);border-radius:100px;position:relative;cursor:pointer;transition:all 0.2s">
<span id="billingDot" style="position:absolute;top:3px;left:3px;width:22px;height:22px;background:var(--accent);border-radius:50%;transition:all 0.2s"></span>
</button>
<span id="yearlyLabel" style="font-weight:600;color:var(--muted)">Yearly <span style="background:rgba(0,255,136,0.2);color:var(--accent);padding:0.2rem 0.5rem;border-radius:100px;font-size:0.75rem;margin-left:0.25rem">Save $10</span></span>
</div>
<div class="pricing-grid">
<div class="price-card featured"><div class="price-badge">Most Popular</div><div class="price-name">Pro</div><div class="price-amount" id="proPrice">$5<span>/mo</span></div><div class="price-period" id="proPeriod">Billed monthly. Cancel anytime.</div>
<ul class="price-features"><li>Unlimited deals</li><li>Tiered commission calculation</li><li>1 year and 2 year rate support</li><li>Quarterly and monthly views</li><li>CSV export</li><li>Mobile friendly</li><li>14 day free trial</li></ul>
<button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Free Trial</button></div>
<div class="price-card"><div class="price-badge" style="background:var(--purple)">Coming Soon</div><div class="price-name">Team</div><div class="price-amount">$49<span>/mo</span></div><div class="price-period">Up to 10 reps</div>
<ul class="price-features"><li>Everything in Pro</li><li>Team dashboard</li><li>Manager controls</li><li>Shared comp plans</li><li>Leaderboards</li><li>Priority support</li><li>Custom onboarding</li></ul>
<button class="btn btn-secondary btn-lg" onclick="showWaitlist()">Join Waitlist</button></div>
</div></div></section>
<section class="cta-section"><div class="cta-content">
<h2>Stop guessing.<br><span class="gradient">Start knowing.</span></h2>
<p>Set up takes 2 minutes. No credit card required. Know exactly what you are taking home.</p>
<button class="btn btn-primary btn-lg" onclick="showAuth('signup')">Start Tracking Free</button>
<p class="cta-note">Free for 14 days. No credit card required.</p>
</div></section>
<section class="section" id="feedback" style="background:linear-gradient(180deg,var(--bg),var(--bg2));position:relative;overflow:hidden">
<div class="glow-1" style="top:-200px;left:50%;transform:translateX(-50%);opacity:0.5"></div>
<div class="container" style="position:relative;z-index:1">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:4rem;align-items:center;max-width:1000px;margin:0 auto">
<div>
<span style="display:inline-block;background:rgba(0,255,136,0.1);border:1px solid rgba(0,255,136,0.2);color:var(--accent);padding:0.5rem 1rem;border-radius:100px;font-size:0.85rem;font-weight:600;margin-bottom:1.5rem">üí¨ We're Listening</span>
<h2 style="font-size:2.5rem;font-weight:800;letter-spacing:-0.03em;line-height:1.2;margin-bottom:1rem">Built by a rep,<br><span style="color:var(--accent)">for reps.</span></h2>
<p style="color:var(--text2);font-size:1.1rem;line-height:1.7;margin-bottom:2rem">Comish started from my own frustration tracking commissions in spreadsheets. Your feedback directly shapes what we build next.</p>
<div style="display:flex;gap:1.5rem">
<div style="text-align:center"><div style="font-size:2rem;font-weight:800;color:var(--accent)">48hr</div><div style="font-size:0.85rem;color:var(--muted)">Response time</div></div>
<div style="text-align:center"><div style="font-size:2rem;font-weight:800;color:var(--accent)">100%</div><div style="font-size:0.85rem;color:var(--muted)">Requests read</div></div>
<div style="text-align:center"><div style="font-size:2rem;font-weight:800;color:var(--accent)">12+</div><div style="font-size:0.85rem;color:var(--muted)">Features shipped</div></div>
</div>
</div>
<div style="background:linear-gradient(135deg,var(--card),var(--card2));border:1px solid var(--border);border-radius:24px;padding:2rem;position:relative;overflow:hidden">
<div style="position:absolute;top:-50px;right:-50px;width:150px;height:150px;background:radial-gradient(circle,rgba(0,255,136,0.15),transparent);border-radius:50%"></div>
<h3 style="font-size:1.25rem;font-weight:700;margin-bottom:1.5rem">Send us your thoughts</h3>
<div style="display:flex;gap:0.5rem;margin-bottom:1.5rem">
<button class="feedback-tab active" onclick="setLandingFeedbackType(this,'feature')" style="flex:1;padding:0.75rem;border:1px solid var(--accent);background:rgba(0,255,136,0.1);color:var(--accent);border-radius:10px;cursor:pointer;font-size:0.85rem;font-family:inherit;font-weight:600;transition:all 0.2s">üí° Feature</button>
<button class="feedback-tab" onclick="setLandingFeedbackType(this,'integration')" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:10px;cursor:pointer;font-size:0.85rem;font-family:inherit;font-weight:500;transition:all 0.2s">üîå Integration</button>
<button class="feedback-tab" onclick="setLandingFeedbackType(this,'other')" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:10px;cursor:pointer;font-size:0.85rem;font-family:inherit;font-weight:500;transition:all 0.2s">üí¨ Other</button>
</div>
<input type="hidden" id="landingFeedbackType" value="feature">
<div class="form-group" style="margin-bottom:1rem"><textarea class="form-input" id="landingFeedbackText" rows="3" placeholder="What would make Comish perfect for you?" style="background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:1rem;color:var(--text);width:100%;font-family:inherit;font-size:0.95rem;resize:none"></textarea></div>
<div class="form-group" style="margin-bottom:1.25rem"><input type="email" class="form-input" id="landingFeedbackEmail" placeholder="your@email.com" style="background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:1rem;color:var(--text);width:100%;font-family:inherit;font-size:0.95rem"></div>
<button class="btn btn-primary" style="width:100%;padding:1rem;font-size:1rem;border-radius:12px" onclick="submitLandingFeedback()">Send Feedback ‚Üí</button>
</div>
</div>
</div>
</section>
<style>@media(max-width:800px){#feedback .container>div{grid-template-columns:1fr!important;gap:2rem!important;text-align:center}#feedback .container>div>div:first-child>div:last-child{justify-content:center}}</style>
<footer>
<div class="footer-content">
<div class="footer-brand"><div class="logo">Com<span>ish</span></div><p>Commission tracking for sales reps who want to know exactly what they are getting paid.</p></div>
<div class="footer-links"><h4>Product</h4><a href="#features">Features</a><a href="#pricing">Pricing</a><a href="#faq">FAQ</a><a href="/blog/">Blog</a><a href="/affiliates.html">Affiliates</a></div>
<div class="footer-links"><h4>Legal</h4><a href="/privacy.html">Privacy Policy</a><a href="/terms.html">Terms of Service</a><a href="/contact.html">Contact</a></div>
</div>
<div class="footer-bottom">¬© 2025 Comish. All rights reserved.</div>
</footer>
</div>
<div class="modal-overlay" id="authModal"><div class="modal"><div class="modal-header"><h2 id="authTitle">Sign Up</h2><button class="modal-close" onclick="hideAuth()">√ó</button></div><div class="modal-body">
<form id="authForm" onsubmit="handleAuth(event)">
<div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="authEmail" required placeholder="you@company.com"></div>
<div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="authPassword" required minlength="6" placeholder="At least 6 characters"></div>
<div class="form-group" id="rememberGroup" style="display:none"><label style="display:flex;align-items:center;gap:0.5rem;cursor:pointer;color:var(--text2);font-size:0.9rem"><input type="checkbox" id="rememberMe" style="width:18px;height:18px;accent-color:var(--accent)"> Remember me</label></div>
<div class="form-error" id="authError"></div>
<button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:0.5rem" id="authSubmit">Sign Up</button>
</form>
<div class="auth-switch" id="authSwitch">Already have an account? <a onclick="toggleAuthMode()">Log in</a></div>
<div class="auth-switch" id="forgotLink" style="display:none;margin-top:0.5rem"><a onclick="showForgotPassword()">Forgot password?</a></div>
</div></div></div>
<div class="modal-overlay" id="forgotModal"><div class="modal"><div class="modal-header"><h2>Reset Password</h2><button class="modal-close" onclick="hideForgotPassword()">√ó</button></div><div class="modal-body">
<p style="color:var(--text2);margin-bottom:1.5rem">Enter your email and we'll send you a reset link.</p>
<form onsubmit="sendResetEmail(event)">
<div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="resetEmail" required placeholder="you@company.com"></div>
<div class="form-error" id="resetError"></div>
<button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:0.5rem" id="resetSubmit">Send Reset Link</button>
</form>
<div class="auth-switch" style="margin-top:1.5rem"><a onclick="hideForgotPassword();showAuth('login')">Back to login</a></div>
</div></div></div>
<div class="trial-expired-modal hidden" id="trialExpiredModal">
<div class="trial-expired-content">
<h2>Your trial has ended</h2>
<p class="subtitle">Subscribe to keep tracking your commissions</p>
<div class="price">$5<span>/month</span></div>
<div class="perks">
<div class="perk"><span>‚úì</span> Unlimited deals</div>
<div class="perk"><span>‚úì</span> Tiered commission calculations</div>
<div class="perk"><span>‚úì</span> Monthly & yearly breakdowns</div>
<div class="perk"><span>‚úì</span> CSV export</div>
<div class="perk"><span>‚úì</span> Cancel anytime</div>
</div>
<button class="btn btn-primary btn-lg" onclick="subscribe()">Subscribe Now</button>
<button class="btn btn-secondary" onclick="logout()" style="margin-top:0.75rem">Log Out</button>
</div>
</div>
<button class="feedback-btn hidden" id="feedbackBtn" onclick="showFeedback()">üí¨ Feedback</button>
<div class="modal-overlay feedback-modal" id="feedbackModal"><div class="modal"><div class="modal-header"><h2>Send Feedback</h2><button class="modal-close" onclick="hideFeedback()">√ó</button></div><div class="modal-body">
<div class="feedback-type">
<button class="active" onclick="setFeedbackType(this,'feature')">üí° Feature Request</button>
<button onclick="setFeedbackType(this,'bug')">üêõ Bug Report</button>
<button onclick="setFeedbackType(this,'other')">üí¨ Other</button>
</div>
<input type="hidden" id="feedbackType" value="feature">
<div class="form-group"><label class="form-label">Your feedback</label><textarea class="form-input" id="feedbackText" rows="5" placeholder="What would make Comish better for you?"></textarea></div>
<div class="form-group"><label class="form-label">Email (optional)</label><input type="email" class="form-input" id="feedbackEmail" placeholder="you@company.com"></div>
<button class="btn btn-primary" style="width:100%" onclick="submitFeedback()">Send Feedback</button>
</div></div></div>
<div class="modal-overlay" id="waitlistModal"><div class="modal"><div class="modal-header"><h2>Join the Team Waitlist</h2><button class="modal-close" onclick="hideWaitlist()">√ó</button></div><div class="modal-body">
<p style="color:var(--text2);margin-bottom:1.5rem">Get notified when Comish for Teams launches. Manage your whole sales floor from one dashboard.</p>
<form onsubmit="submitWaitlist(event)">
<div class="form-group"><label class="form-label">Work Email</label><input type="email" class="form-input" id="waitlistEmail" required placeholder="you@company.com"></div>
<div class="form-group"><label class="form-label">Team Size</label><select class="form-input" id="waitlistSize"><option>1-5 reps</option><option>6-10 reps</option><option>11-25 reps</option><option>25+ reps</option></select></div>
<button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:0.5rem">Join Waitlist</button>
</form>
</div></div></div>
<div id="app">
<div id="onboarding" class="onboarding hidden"><div class="onboard-card">
<div class="onboard-header"><h2 id="onboardTitle">What's your role?</h2><p id="onboardDesc">We'll customize your commission tracking</p>
<div class="onboard-progress"><div class="step active" id="ob-step-1"></div><div class="step" id="ob-step-2"></div><div class="step" id="ob-step-3"></div><div class="step" id="ob-step-4"></div></div></div>
<div class="onboard-body">
<div id="ob-content-1">
<div style="display:grid;gap:1rem">
<div class="role-card" onclick="selectRole('ae')" id="roleAE" style="background:var(--card2);border:2px solid var(--border);border-radius:12px;padding:1.5rem;cursor:pointer;transition:all 0.2s">
<div style="display:flex;align-items:center;gap:1rem"><span style="font-size:1.75rem">üíº</span><div><strong style="font-size:1.1rem">AE / Closer</strong><p style="color:var(--text2);font-size:0.9rem;margin-top:0.25rem">Revenue-based commission with tiered rates</p></div></div>
</div>
<div class="role-card" onclick="selectRole('sdr')" id="roleSDR" style="background:var(--card2);border:2px solid var(--border);border-radius:12px;padding:1.5rem;cursor:pointer;transition:all 0.2s">
<div style="display:flex;align-items:center;gap:1rem"><span style="font-size:1.75rem">üìû</span><div><strong style="font-size:1.1rem">SDR / BDR</strong><p style="color:var(--text2);font-size:0.9rem;margin-top:0.25rem">Activity-based pay (meetings, SQLs, etc.)</p></div></div>
</div>
</div>
<input type="hidden" id="obRole" value="">
</div>
<div id="ob-content-2" class="hidden">
<div id="ae-step2"><div class="form-group"><label class="form-label">Quarterly Goal ($)</label><input type="number" class="form-input" id="obGoal" value="375000" style="font-size:1.5rem;text-align:center"></div></div>
<div id="sdr-step2" class="hidden">
<div class="form-group"><label class="form-label">Quota Period</label>
<div style="display:flex;gap:0.5rem;margin-top:0.5rem">
<button type="button" class="period-btn active" onclick="setPeriod('monthly')" id="periodMonthly" style="flex:1;padding:0.75rem;border:1px solid var(--accent);background:rgba(0,255,136,0.1);color:var(--accent);border-radius:8px;cursor:pointer;font-family:inherit;font-weight:600">Monthly</button>
<button type="button" class="period-btn" onclick="setPeriod('quarterly')" id="periodQuarterly" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:8px;cursor:pointer;font-family:inherit;font-weight:500">Quarterly</button>
</div>
<input type="hidden" id="obPeriod" value="monthly">
</div>
<div class="form-group" style="margin-top:1.25rem"><label class="form-label">Activity Quota (per period)</label><input type="number" class="form-input" id="obActivityQuota" value="15" style="font-size:1.5rem;text-align:center"><div style="color:var(--muted);font-size:0.85rem;margin-top:0.5rem;text-align:center">meetings, SQLs, or primary activity</div></div>
</div>
</div>
<div id="ob-content-3" class="hidden">
<div id="ae-step3"><div class="form-group"><label class="form-label">Tier Thresholds (% of goal)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" value="0" disabled></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obTh2" value="100"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obTh3" value="125"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obTh4" value="150"></div></div></div></div>
<div id="sdr-step3" class="hidden">
<div class="form-group"><label class="form-label">What do you get paid for?</label>
<div style="display:grid;gap:0.75rem;margin-top:0.75rem">
<label style="display:flex;align-items:center;gap:0.75rem;background:var(--card2);padding:1rem;border-radius:8px;cursor:pointer;border:1px solid var(--border)"><input type="checkbox" id="payMeeting" checked style="width:18px;height:18px;accent-color:var(--accent)"><span>Meetings booked</span></label>
<label style="display:flex;align-items:center;gap:0.75rem;background:var(--card2);padding:1rem;border-radius:8px;cursor:pointer;border:1px solid var(--border)"><input type="checkbox" id="paySQL" style="width:18px;height:18px;accent-color:var(--accent)"><span>SQLs (Sales Qualified Leads)</span></label>
<label style="display:flex;align-items:center;gap:0.75rem;background:var(--card2);padding:1rem;border-radius:8px;cursor:pointer;border:1px solid var(--border)"><input type="checkbox" id="payShow" style="width:18px;height:18px;accent-color:var(--accent)"><span>Show rate bonus (meeting held)</span></label>
</div>
</div>
</div>
</div>
<div id="ob-content-4" class="hidden">
<div id="ae-step4"><div class="form-group"><label class="form-label">1 Year Contract Rates (%)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" id="obR1a" value="6"></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obR1b" value="8"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obR1c" value="10"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obR1d" value="12"></div></div></div>
<div class="form-group" style="margin-top:1.5rem"><label class="form-label">2 Year Contract Rates (%)</label><div class="rate-grid"><div><div class="rate-label">Tier 1</div><input type="number" class="form-input" id="obR2a" value="8"></div><div><div class="rate-label">Tier 2</div><input type="number" class="form-input" id="obR2b" value="10"></div><div><div class="rate-label">Tier 3</div><input type="number" class="form-input" id="obR2c" value="12"></div><div><div class="rate-label">Tier 4</div><input type="number" class="form-input" id="obR2d" value="14"></div></div></div></div>
<div id="sdr-step4" class="hidden">
<div class="form-group" id="meetingRateGroup"><label class="form-label">Pay per Meeting Booked ($)</label><input type="number" class="form-input" id="obMeetingRate" value="75" style="font-size:1.25rem;text-align:center"></div>
<div class="form-group" id="sqlRateGroup" style="margin-top:1.25rem;display:none"><label class="form-label">Pay per SQL ($)</label><input type="number" class="form-input" id="obSQLRate" value="150" style="font-size:1.25rem;text-align:center"></div>
<div class="form-group" id="showRateGroup" style="margin-top:1.25rem;display:none"><label class="form-label">Show Rate Bonus ($)</label><input type="number" class="form-input" id="obShowRate" value="25" style="font-size:1.25rem;text-align:center"><div style="color:var(--muted);font-size:0.85rem;margin-top:0.5rem;text-align:center">Extra bonus when meeting actually happens</div></div>
</div>
</div>
</div>
<div class="onboard-footer"><button class="btn btn-ghost" id="obBack" onclick="onboardBack()" style="visibility:hidden">Back</button><button class="btn btn-primary" id="obNext" onclick="onboardNext()">Continue</button></div>
</div></div>
<div id="dashboard" class="dashboard hidden">
<nav class="dash-nav"><div class="logo">Com<span>ish</span></div><div class="user-menu"><span class="user-email" id="userEmail"></span><button class="btn btn-ghost" onclick="showProfile()">Account</button><button class="btn btn-ghost" onclick="logout()">Log out</button></div></nav>
<div class="dash-container">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem">
<div class="view-toggle"><button class="active" onclick="setView('quarter')">Quarter</button><button onclick="setView('year')">Year</button></div>
<div style="display:flex;gap:0.75rem"><select id="yearSelect" onchange="render()" style="background:var(--card);border:1px solid var(--border);border-radius:10px;padding:0.625rem 1rem;color:var(--text)"></select><select id="quarterSelect" onchange="render()" style="background:var(--card);border:1px solid var(--border);border-radius:10px;padding:0.625rem 1rem;color:var(--text)"><option value="Q1">Q1</option><option value="Q2">Q2</option><option value="Q3">Q3</option><option value="Q4">Q4</option></select></div>
<div style="display:flex;gap:0.75rem;flex-wrap:wrap"><button class="btn btn-secondary" onclick="openForecast()">üîÆ Forecast</button><button class="btn btn-secondary" onclick="exportPDF()">üìÑ PDF</button><button class="btn btn-secondary" onclick="exportCSV()">üì§ CSV</button><button class="btn btn-secondary" onclick="openSettings()">‚öôÔ∏è Settings</button><button class="btn btn-primary" onclick="openDeal()">+ Add Deal</button></div>
</div>
<div id="quarterView">
<div class="quick-entry">
<div><label>Starting Point</label><div style="display:flex;gap:0.5rem;align-items:center;margin-top:0.375rem"><span style="color:var(--muted);font-size:1.25rem">$</span><input type="number" id="startingPoint" placeholder="0" onchange="saveStarting()"></div><div class="hint">Revenue already closed this quarter before tracking</div></div>
<div style="margin-left:auto;text-align:right"><div style="font-size:0.75rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.05em">Quarterly Total</div><div style="font-size:2rem;font-weight:900;color:var(--accent)" id="qtdTotal">$0</div></div>
</div>
<div class="stats">
<div class="stat"><div class="stat-label">Quarterly Goal</div><div class="stat-value" id="qGoal">$375,000</div><div class="stat-sub" id="attainmentPct">0%</div></div>
<div class="stat"><div class="stat-label">Current Tier</div><div class="stat-value green" id="currentTier">Tier 1</div><div class="stat-sub" id="tierRates">1yr: 6% ¬∑ 2yr: 8%</div></div>
<div class="stat"><div class="stat-label">To Next Tier</div><div class="stat-value yellow" id="toNext">$375,000</div><div class="stat-sub" id="nextTierName">to Tier 2</div></div>
<div class="stat"><div class="stat-label">This Month</div><div class="stat-value blue" id="monthTotal">$0</div><div class="stat-sub" id="monthDeals">0 deals</div></div>
<div class="stat hl"><div class="stat-label">Total Commission</div><div class="stat-value green" id="totalCommStat">$0</div><div class="stat-sub">blended across tiers</div></div>
</div>
<div class="progress-section">
<div class="progress-header"><span class="progress-title">Quarterly Progress</span><div class="progress-stats"><span><strong id="closedAmt">$0</strong> closed</span><span><strong id="remainingAmt">$375K</strong> to goal</span></div></div>
<div class="progress-bar-wrap"><div class="progress-bar" id="progressBar" style="width:0%"></div></div>
<div class="progress-labels"><span>0%</span><span>100%</span><span>125%</span><span>150%</span><span>175%+</span></div>
</div>
<div class="main-grid">
<div class="card"><div class="card-header"><span class="card-title">Deals</span><select id="monthFilter" onchange="renderDeals()" style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:0.5rem 0.75rem;color:var(--text)"><option value="all">All Months</option></select></div>
<div class="table-wrap"><table><thead><tr><th>Client</th><th>Amount</th><th>Term</th><th>Date</th><th>Status</th><th></th></tr></thead><tbody id="dealsBody"></tbody></table><div class="empty" id="emptyDeals" style="display:none">No deals yet.<br><button class="btn btn-primary" onclick="openDeal()" style="margin-top:1rem">Add your first deal</button></div></div></div>
<div class="sidebar-cards">
<div class="side-card"><div class="side-title">Commission by Tier</div><div id="tierBreakdown"></div><div class="comm-summary"><div class="comm-row"><span class="comm-label">1 Year Deals</span><span class="comm-value blue" id="y1Comm">$0</span></div><div class="comm-row"><span class="comm-label">2 Year Deals</span><span class="comm-value purple" id="y2Comm">$0</span></div><div class="comm-row total"><span class="comm-label">Total</span><span class="comm-value" id="totalComm">$0</span></div></div></div>
<div class="side-card"><div class="side-title">Revenue</div><div class="comm-row"><span class="comm-label">1 Year</span><span class="comm-value blue" id="y1Rev">$0</span></div><div class="comm-row"><span class="comm-label">2 Year</span><span class="comm-value purple" id="y2Rev">$0</span></div><div class="comm-row total"><span class="comm-label">Deals Total</span><span class="comm-value" id="totalRev">$0</span></div></div>
</div></div></div>
</div>
<div id="yearView" class="hidden" style="padding:0 2rem 2rem;max-width:1400px;margin:0 auto">
<div class="yearly-summary" id="yearlySummary"></div>
<div class="chart-section">
<div class="chart-header">
<span class="chart-title">Monthly Performance</span>
<div class="chart-legend">
<div class="chart-legend-item"><span class="chart-legend-dot" style="background:linear-gradient(180deg,var(--blue),var(--purple))"></span>Revenue</div>
<div class="chart-legend-item"><span class="chart-legend-dot" style="background:linear-gradient(180deg,var(--accent),var(--accent2))"></span>Commission</div>
</div>
</div>
<div class="bar-chart" id="barChart"></div>
</div>
<div class="chart-section">
<div class="chart-header"><span class="chart-title">Quarter Comparison</span></div>
<div class="quarter-compare" id="quarterCompare"></div>
</div>
<div class="monthly-section">
<div class="monthly-header"><span class="monthly-title">Monthly Breakdown</span></div>
<div class="monthly-grid" id="monthlyGrid"></div>
</div>
</div>
</div>
<div id="sdrDashboard" class="dashboard hidden">
<nav class="dash-nav"><div class="logo">Com<span>ish</span></div><div class="user-menu"><span class="user-email" id="sdrUserEmail"></span><button class="btn btn-ghost" onclick="showProfile()">Account</button><button class="btn btn-ghost" onclick="logout()">Log out</button></div></nav>
<div class="dash-container">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem">
<h2 style="font-size:1.5rem;font-weight:700">Activity Dashboard</h2>
<div style="display:flex;gap:0.75rem;flex-wrap:wrap">
<select id="sdrMonthSelect" onchange="renderSDR()" style="background:var(--card);border:1px solid var(--border);border-radius:10px;padding:0.625rem 1rem;color:var(--text)"></select>
<button class="btn btn-secondary" onclick="openSDRSettings()">‚öôÔ∏è Settings</button>
<button class="btn btn-primary" onclick="openActivity()">+ Log Activity</button>
</div>
</div>
<div class="stats">
<div class="stat"><div class="stat-label">Period Quota</div><div class="stat-value" id="sdrQuota">15</div><div class="stat-sub" id="sdrPeriodLabel">meetings this month</div></div>
<div class="stat"><div class="stat-label">Completed</div><div class="stat-value green" id="sdrCompleted">0</div><div class="stat-sub" id="sdrCompletedPct">0% of quota</div></div>
<div class="stat"><div class="stat-label">To Quota</div><div class="stat-value yellow" id="sdrToQuota">15</div><div class="stat-sub">remaining</div></div>
<div class="stat hl"><div class="stat-label">Earnings This Period</div><div class="stat-value green" id="sdrEarnings">$0</div><div class="stat-sub" id="sdrEarningsBreakdown">-</div></div>
</div>
<div class="progress-section">
<div class="progress-header"><span class="progress-title">Quota Progress</span><div class="progress-stats"><span><strong id="sdrDoneCount">0</strong> completed</span><span><strong id="sdrLeftCount">15</strong> to go</span></div></div>
<div class="progress-bar-wrap"><div class="progress-bar" id="sdrProgressBar" style="width:0%"></div></div>
<div class="progress-labels"><span>0%</span><span>50%</span><span>100%</span><span>125%</span><span>150%+</span></div>
</div>
<div class="main-grid">
<div class="card"><div class="card-header"><span class="card-title">Activities</span><select id="sdrActivityFilter" onchange="renderSDRActivities()" style="background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:0.5rem 0.75rem;color:var(--text)"><option value="all">All Types</option><option value="meeting">Meetings</option><option value="sql">SQLs</option><option value="show">Shows</option></select></div>
<div class="table-wrap"><table><thead><tr><th>Type</th><th>Description</th><th>Date</th><th>Payout</th><th></th></tr></thead><tbody id="sdrActivitiesBody"></tbody></table><div class="empty" id="emptyActivities" style="display:none">No activities yet.<br><button class="btn btn-primary" onclick="openActivity()" style="margin-top:1rem">Log your first activity</button></div></div></div>
<div class="sidebar-cards">
<div class="side-card"><div class="side-title">Earnings Breakdown</div>
<div class="comm-row" id="meetingEarningsRow"><span class="comm-label">üìÖ Meetings</span><span class="comm-value green" id="meetingEarnings">$0</span></div>
<div class="comm-row" id="sqlEarningsRow" style="display:none"><span class="comm-label">üéØ SQLs</span><span class="comm-value blue" id="sqlEarnings">$0</span></div>
<div class="comm-row" id="showEarningsRow" style="display:none"><span class="comm-label">‚úÖ Show Bonuses</span><span class="comm-value purple" id="showEarnings">$0</span></div>
<div class="comm-row total"><span class="comm-label">Total</span><span class="comm-value" id="sdrTotalEarnings">$0</span></div>
</div>
<div class="side-card"><div class="side-title">Activity Count</div>
<div class="comm-row" id="meetingCountRow"><span class="comm-label">üìÖ Meetings</span><span class="comm-value" id="meetingCount">0</span></div>
<div class="comm-row" id="sqlCountRow" style="display:none"><span class="comm-label">üéØ SQLs</span><span class="comm-value" id="sqlCount">0</span></div>
<div class="comm-row" id="showCountRow" style="display:none"><span class="comm-label">‚úÖ Shows</span><span class="comm-value" id="showCount">0</span></div>
</div>
</div></div>
</div>
</div>
<div id="activityModal" class="modal-overlay"><div class="modal">
<div class="modal-header"><h2 id="activityModalTitle">Log Activity</h2><button class="modal-close" onclick="closeActivity()">√ó</button></div>
<div class="modal-body">
<div class="form-group"><label class="form-label">Activity Type</label><select class="form-input" id="activityType" onchange="updateActivityForm()"><option value="meeting">üìÖ Meeting Booked</option><option value="sql">üéØ SQL Generated</option><option value="show">‚úÖ Meeting Held (Show)</option></select></div>
<div class="form-group"><label class="form-label">Description</label><input type="text" class="form-input" id="activityDesc" placeholder="e.g., Acme Corp discovery call"></div>
<div class="form-group"><label class="form-label">Date</label><input type="date" class="form-input" id="activityDate"></div>
<div class="form-group" id="activityPayoutGroup"><label class="form-label">Payout</label><div class="form-input" id="activityPayout" style="background:var(--card2);color:var(--accent)">$75</div></div>
<button class="btn btn-primary" style="width:100%;margin-top:1rem" onclick="saveActivity()">Save Activity</button>
</div>
</div></div>
<div id="sdrSettingsModal" class="modal-overlay"><div class="modal">
<div class="modal-header"><h2>SDR Settings</h2><button class="modal-close" onclick="closeSDRSettings()">√ó</button></div>
<div class="modal-body">
<div class="form-group"><label class="form-label">Quota Period</label>
<div style="display:flex;gap:0.5rem">
<button type="button" onclick="setSDRPeriod('monthly')" id="sdrSetMonthly" style="flex:1;padding:0.75rem;border:1px solid var(--accent);background:rgba(0,255,136,0.1);color:var(--accent);border-radius:8px;cursor:pointer;font-family:inherit">Monthly</button>
<button type="button" onclick="setSDRPeriod('quarterly')" id="sdrSetQuarterly" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:8px;cursor:pointer;font-family:inherit">Quarterly</button>
</div></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Activity Quota</label><input type="number" class="form-input" id="sdrSetQuota" value="15"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Pay per Meeting ($)</label><input type="number" class="form-input" id="sdrSetMeetingRate" value="75"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Pay per SQL ($)</label><input type="number" class="form-input" id="sdrSetSQLRate" value="150"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Show Bonus ($)</label><input type="number" class="form-input" id="sdrSetShowRate" value="25"></div>
<button class="btn btn-primary" style="width:100%;margin-top:1.5rem" onclick="saveSDRSettings()">Save Settings</button>
</div>
</div></div>
<div id="compSettingsModal" class="modal-overlay"><div class="modal" style="max-width:500px">
<div class="modal-header"><h2>Commission Settings</h2><button class="modal-close" onclick="closeCompSettings()">√ó</button></div>
<div class="modal-body">
<div class="form-group"><label class="form-label">Your Role</label>
<div style="display:flex;gap:0.5rem">
<button type="button" onclick="setCompRole('ae')" id="compRoleAE" style="flex:1;padding:0.75rem;border:1px solid var(--accent);background:rgba(0,255,136,0.1);color:var(--accent);border-radius:8px;cursor:pointer;font-family:inherit;font-weight:600">AE / Closer</button>
<button type="button" onclick="setCompRole('sdr')" id="compRoleSDR" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:8px;cursor:pointer;font-family:inherit;font-weight:600">SDR / BDR</button>
</div></div>
<div id="aeSettingsFields">
<div class="form-group" style="margin-top:1.5rem"><label class="form-label">Quarterly Quota ($)</label><input type="number" class="form-input" id="compQuota" value="375000"></div>
<p style="color:var(--muted);font-size:0.85rem;margin:1rem 0 0.5rem">Tier Thresholds (% of quota)</p>
<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem">
<div><label style="font-size:0.75rem;color:var(--muted)">T1</label><input type="number" class="form-input" value="0" disabled style="text-align:center;background:var(--card2)"></div>
<div><label style="font-size:0.75rem;color:var(--muted)">T2</label><input type="number" class="form-input" id="compTh2" value="100" style="text-align:center"></div>
<div><label style="font-size:0.75rem;color:var(--muted)">T3</label><input type="number" class="form-input" id="compTh3" value="125" style="text-align:center"></div>
<div><label style="font-size:0.75rem;color:var(--muted)">T4</label><input type="number" class="form-input" id="compTh4" value="150" style="text-align:center"></div>
</div>
<p style="color:var(--muted);font-size:0.85rem;margin:1rem 0 0.5rem">1-Year Rates (%)</p>
<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem">
<input type="number" class="form-input" id="compR1a" value="6" style="text-align:center">
<input type="number" class="form-input" id="compR1b" value="8" style="text-align:center">
<input type="number" class="form-input" id="compR1c" value="10" style="text-align:center">
<input type="number" class="form-input" id="compR1d" value="12" style="text-align:center">
</div>
<p style="color:var(--muted);font-size:0.85rem;margin:1rem 0 0.5rem">2-Year Rates (%)</p>
<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:0.5rem">
<input type="number" class="form-input" id="compR2a" value="8" style="text-align:center">
<input type="number" class="form-input" id="compR2b" value="10" style="text-align:center">
<input type="number" class="form-input" id="compR2c" value="12" style="text-align:center">
<input type="number" class="form-input" id="compR2d" value="14" style="text-align:center">
</div>
</div>
<div id="sdrSettingsFields" style="display:none">
<div class="form-group" style="margin-top:1.5rem"><label class="form-label">Quota Period</label>
<div style="display:flex;gap:0.5rem">
<button type="button" onclick="setCompPeriod('monthly')" id="compMonthly" style="flex:1;padding:0.75rem;border:1px solid var(--accent);background:rgba(0,255,136,0.1);color:var(--accent);border-radius:8px;cursor:pointer;font-family:inherit">Monthly</button>
<button type="button" onclick="setCompPeriod('quarterly')" id="compQuarterly" style="flex:1;padding:0.75rem;border:1px solid var(--border);background:transparent;color:var(--text2);border-radius:8px;cursor:pointer;font-family:inherit">Quarterly</button>
</div></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Activity Quota</label><input type="number" class="form-input" id="compActivityQuota" value="15"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Pay per Meeting ($)</label><input type="number" class="form-input" id="compMeetingRate" value="75"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Pay per SQL ($)</label><input type="number" class="form-input" id="compSQLRate" value="150"></div>
<div class="form-group" style="margin-top:1rem"><label class="form-label">Show Bonus ($)</label><input type="number" class="form-input" id="compShowRate" value="25"></div>
</div>
<button class="btn btn-primary" style="width:100%;margin-top:1.5rem" onclick="saveCompSettings()">Save Settings</button>
</div>
</div></div>
<div id="profilePage" class="profile-page hidden">
<nav class="dash-nav"><div class="logo">Com<span>ish</span></div><div class="user-menu"><span class="user-email" id="profileUserEmail"></span><button class="btn btn-ghost" onclick="logout()">Log out</button></div></nav>
<div class="profile-container">
<div class="profile-header">
<h1>Account Settings</h1>
<p>Manage your profile and subscription</p>
</div>
<div class="trial-banner" id="trialBanner">
<div class="trial-banner-text">
<span>‚è∞</span>
<div class="trial-banner-info">
<strong id="trialDaysLeft">14 days left in your free trial</strong>
<p>Subscribe to keep tracking your commission</p>
</div>
</div>
<button class="btn btn-primary" onclick="subscribe()">Subscribe - $5/mo</button>
</div>
<div class="profile-card">
<div class="profile-card-title">Subscription</div>
<div class="profile-row">
<span class="profile-row-label">Status</span>
<span class="subscription-badge trial" id="subStatus">Free Trial</span>
</div>
<div class="profile-row">
<span class="profile-row-label">Plan</span>
<span class="profile-row-value">Pro - $5/month</span>
</div>
<div class="profile-row" id="renewalRow" style="display:none">
<span class="profile-row-label">Next billing date</span>
<span class="profile-row-value" id="renewalDate">-</span>
</div>
<div class="profile-row" id="manageSubRow" style="display:none">
<span class="profile-row-label">Manage</span>
<button class="btn btn-secondary" onclick="manageSubscription()">Manage Subscription</button>
</div>
</div>
<div class="profile-card">
<div class="profile-card-title">Account</div>
<div class="profile-row">
<span class="profile-row-label">Email</span>
<span class="profile-row-value" id="profileEmail">-</span>
</div>
<div class="profile-row">
<span class="profile-row-label">Password</span>
<button class="btn btn-secondary" onclick="showChangePassword()">Change Password</button>
</div>
</div>
<div class="profile-card">
<div class="profile-card-title">Commission Settings</div>
<div class="profile-row">
<span class="profile-row-label">Role</span>
<span class="profile-row-value" id="profileRole">-</span>
</div>
<div class="profile-row" id="profileQuotaRow">
<span class="profile-row-label" id="profileQuotaLabel">Quarterly Quota</span>
<span class="profile-row-value" id="profileQuota">-</span>
</div>
<div class="profile-row">
<span class="profile-row-label">Comp Plan</span>
<button class="btn btn-secondary" onclick="openCompSettings()">Edit Settings</button>
</div>
</div>
<div class="profile-card danger-zone">
<div class="profile-card-title">Danger Zone</div>
<div class="profile-row">
<span class="profile-row-label">Delete all your data and close your account</span>
<button class="btn btn-danger" onclick="deleteAccount()">Delete Account</button>
</div>
</div>
<button class="btn btn-secondary" onclick="hideProfile()" style="margin-top:1rem">‚Üê Back to Dashboard</button>
</div>
</div>
<div class="modal-overlay deal-modal" id="dealModal"><div class="modal"><div class="modal-header"><h2 id="dealModalTitle">Add Deal</h2><button class="modal-close" onclick="closeDeal()">√ó</button></div><div class="modal-body"><input type="hidden" id="editId">
<div class="form-group"><label class="form-label">Client Name</label><input type="text" class="form-input" id="dealName" placeholder="Acme Corp"></div>
<div class="form-row"><div class="form-group"><label class="form-label">Amount ($)</label><input type="number" class="form-input" id="dealAmt" placeholder="50000"></div><div class="form-group"><label class="form-label">Close Date</label><input type="date" class="form-input" id="dealDate"></div></div>
<div class="form-group"><label class="form-label">Contract Length</label><div class="toggle-group"><div class="toggle-opt y1 active" onclick="setTerm(1)">1 Year</div><div class="toggle-opt y2" onclick="setTerm(2)">2 Year</div></div><input type="hidden" id="dealTerm" value="1"></div>
<div class="form-group"><label class="form-label">Payment Status</label><div class="toggle-group"><div class="toggle-opt active" onclick="setPaid(false)" id="unpaidOpt">Unpaid</div><div class="toggle-opt" onclick="setPaid(true)" id="paidOpt">Paid</div></div><input type="hidden" id="dealPaid" value="false"></div>
</div><div style="padding:1.25rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:0.75rem"><button class="btn btn-secondary" onclick="closeDeal()">Cancel</button><button class="btn btn-primary" onclick="saveDeal()">Save Deal</button></div></div></div>
<div class="modal-overlay" id="settingsModal"><div class="modal"><div class="modal-header"><h2>Settings</h2><button class="modal-close" onclick="closeSettings()">√ó</button></div><div class="modal-body">
<div class="form-group"><label class="form-label">Quarterly Goal ($)</label><input type="number" class="form-input" id="setGoal"></div>
<div class="form-group"><label class="form-label">Tier Thresholds (%)</label><div class="rate-grid"><div><div class="rate-label">T1</div><input type="number" class="form-input" value="0" disabled></div><div><div class="rate-label">T2</div><input type="number" class="form-input" id="setTh2"></div><div><div class="rate-label">T3</div><input type="number" class="form-input" id="setTh3"></div><div><div class="rate-label">T4</div><input type="number" class="form-input" id="setTh4"></div></div></div>
<div class="form-group"><label class="form-label">1 Year Rates (%)</label><div class="rate-grid"><input type="number" class="form-input" id="setR1a"><input type="number" class="form-input" id="setR1b"><input type="number" class="form-input" id="setR1c"><input type="number" class="form-input" id="setR1d"></div></div>
<div class="form-group"><label class="form-label">2 Year Rates (%)</label><div class="rate-grid"><input type="number" class="form-input" id="setR2a"><input type="number" class="form-input" id="setR2b"><input type="number" class="form-input" id="setR2c"><input type="number" class="form-input" id="setR2d"></div></div>
</div><div style="padding:1.25rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:0.75rem"><button class="btn btn-secondary" onclick="closeSettings()">Cancel</button><button class="btn btn-primary" onclick="saveSettings()">Save</button></div></div></div>
<div class="modal-overlay" id="forecastModal"><div class="modal" style="max-width:500px"><div class="modal-header"><h2>üîÆ Forecast Calculator</h2><button class="modal-close" onclick="closeForecast()">√ó</button></div><div class="modal-body" id="forecastContent"></div><div style="padding:1.25rem 2rem;border-top:1px solid var(--border);display:flex;justify-content:flex-end"><button class="btn btn-secondary" onclick="closeForecast()">Close</button></div></div></div>
<div class="modal-overlay" id="passwordModal"><div class="modal"><div class="modal-header"><h2>Change Password</h2><button class="modal-close" onclick="hideChangePassword()">√ó</button></div><div class="modal-body">
<form onsubmit="changePassword(event)">
<div class="form-group"><label class="form-label">New Password</label><input type="password" class="form-input" id="newPassword" required minlength="6" placeholder="At least 6 characters"></div>
<div class="form-group"><label class="form-label">Confirm Password</label><input type="password" class="form-input" id="confirmPassword" required minlength="6" placeholder="Confirm new password"></div>
<div class="form-error" id="passwordError"></div>
<button type="submit" class="btn btn-primary btn-lg" style="width:100%;margin-top:0.5rem">Update Password</button>
</form>
</div></div></div>
<div class="toast-wrap" id="toasts"></div>
<script>
const SUPABASE_URL='https://yeecmrjkkujtsvrtatlg.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InllZWNtcmpra3VqdHN2cnRhdGxnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMTA5MzMsImV4cCI6MjA4MDc4NjkzM30.bKr372_-0v2yVGkDFJ87ys5gxQN6qzS5smLLvPmrar0';
let supabase,user=null,compPlan=null,deals=[],startingPoints={};
const $=id=>document.getElementById(id);
const fmt=n=>new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0}).format(n||0);
function toast(m){const t=document.createElement('div');t.className='toast';t.textContent=m;$('toasts').appendChild(t);setTimeout(()=>t.remove(),3000)}
function toggleMobileNav(){$('navLinks').classList.toggle('open')}
function closeMobileNav(){$('navLinks').classList.remove('open')}
function toggleFaq(el){el.parentElement.classList.toggle('open')}
let authMode='signup';
function showAuth(m){authMode=m;$('authModal').classList.add('active');$('authTitle').textContent=m==='signup'?'Create Account':'Welcome Back';$('authSubmit').textContent=m==='signup'?'Create Account':'Log In';$('authSwitch').innerHTML=m==='signup'?'Already have an account? <a onclick="toggleAuthMode()">Log in</a>':'Need an account? <a onclick="toggleAuthMode()">Sign up</a>';$('forgotLink').style.display=m==='login'?'block':'none';$('rememberGroup').style.display=m==='login'?'block':'none';$('authError').classList.remove('show')}
function hideAuth(){$('authModal').classList.remove('active')}
function toggleAuthMode(){showAuth(authMode==='signup'?'login':'signup')}
function showForgotPassword(){hideAuth();$('forgotModal').classList.add('active');$('resetEmail').value='';$('resetError').classList.remove('show')}
function hideForgotPassword(){$('forgotModal').classList.remove('active')}
async function sendResetEmail(e){e.preventDefault();const email=$('resetEmail').value;$('resetSubmit').disabled=true;$('resetSubmit').textContent='Sending...';$('resetError').classList.remove('show');try{const{error}=await supabase.auth.resetPasswordForEmail(email,{redirectTo:'https://comish.online/'});if(error)throw error;hideForgotPassword();toast('Check your email for the reset link!')}catch(err){$('resetError').textContent=err.message;$('resetError').classList.add('show')}finally{$('resetSubmit').disabled=false;$('resetSubmit').textContent='Send Reset Link'}}
function showWaitlist(){$('waitlistModal').classList.add('active')}
function hideWaitlist(){$('waitlistModal').classList.remove('active')}
async function submitWaitlist(e){e.preventDefault();const email=$('waitlistEmail').value;const size=$('waitlistSize').value;try{await supabase.from('waitlist').insert({email,team_size:size});toast('Thanks! We will notify you when Teams launches.');hideWaitlist()}catch(err){toast('Thanks! We will notify you at '+email);hideWaitlist()}}
async function handleAuth(e){e.preventDefault();const email=$('authEmail').value,pw=$('authPassword').value;$('authSubmit').disabled=true;$('authSubmit').textContent='Please wait...';$('authError').classList.remove('show');try{let r;if(authMode==='signup'){r=await supabase.auth.signUp({email,password:pw});if(r.data?.user&&!r.data?.session){hideAuth();toast('Check your email to confirm your account!');return}}else{r=await supabase.auth.signInWithPassword({email,password:pw})}if(r.error)throw r.error;hideAuth()}catch(e){$('authError').textContent=e.message;$('authError').classList.add('show')}finally{$('authSubmit').disabled=false;$('authSubmit').textContent=authMode==='signup'?'Create Account':'Log In'}}
async function logout(){await supabase.auth.signOut();user=null;compPlan=null;deals=[];userProfile=null;window.sdrPlan=null;sdrActivities=[];$('app').style.display='none';$('landing').style.display='block';$('dashboard').classList.add('hidden');$('sdrDashboard').classList.add('hidden');$('profilePage').classList.add('hidden');$('onboarding').classList.add('hidden');$('feedbackBtn').classList.add('hidden');$('trialExpiredModal').classList.add('hidden')}
let onboardStep=1;
let selectedRole='';
function showOnboarding(){$('onboarding').classList.remove('hidden');$('dashboard').classList.add('hidden');$('sdrDashboard')?.classList.add('hidden');onboardStep=1;selectedRole='';$('obRole').value='';updateOnboardUI()}
function selectRole(role){selectedRole=role;$('obRole').value=role;document.querySelectorAll('.role-card').forEach(c=>c.style.borderColor='var(--border)');$(role==='ae'?'roleAE':'roleSDR').style.borderColor='var(--accent)'}
function setPeriod(p){$('obPeriod').value=p;$('periodMonthly').style.borderColor=p==='monthly'?'var(--accent)':'var(--border)';$('periodMonthly').style.background=p==='monthly'?'rgba(0,255,136,0.1)':'transparent';$('periodMonthly').style.color=p==='monthly'?'var(--accent)':'var(--text2)';$('periodQuarterly').style.borderColor=p==='quarterly'?'var(--accent)':'var(--border)';$('periodQuarterly').style.background=p==='quarterly'?'rgba(0,255,136,0.1)':'transparent';$('periodQuarterly').style.color=p==='quarterly'?'var(--accent)':'var(--text2)'}
function updateOnboardUI(){for(let i=1;i<=4;i++){$(`ob-step-${i}`).className='step'+(i<onboardStep?' done':i===onboardStep?' active':'');$(`ob-content-${i}`).classList.toggle('hidden',i!==onboardStep)}$('obBack').style.visibility=onboardStep===1?'hidden':'visible';$('obNext').textContent=onboardStep===4?'Finish Setup':'Continue';const isSDR=selectedRole==='sdr';if(onboardStep===1){$('onboardTitle').textContent="What's your role?";$('onboardDesc').textContent="We'll customize your commission tracking"}else if(onboardStep===2){$('ae-step2').classList.toggle('hidden',isSDR);$('sdr-step2').classList.toggle('hidden',!isSDR);$('onboardTitle').textContent=isSDR?'Set Your Activity Quota':'Set Your Quarterly Goal';$('onboardDesc').textContent=isSDR?'How many activities per period?':'What is your quota for the quarter?'}else if(onboardStep===3){$('ae-step3').classList.toggle('hidden',isSDR);$('sdr-step3').classList.toggle('hidden',!isSDR);$('onboardTitle').textContent=isSDR?'Activity Types':'Configure Tier Thresholds';$('onboardDesc').textContent=isSDR?'What do you get paid for?':'At what % of goal do you hit each tier?'}else if(onboardStep===4){$('ae-step4').classList.toggle('hidden',isSDR);$('sdr-step4').classList.toggle('hidden',!isSDR);$('onboardTitle').textContent=isSDR?'Set Your Rates':'Set Commission Rates';$('onboardDesc').textContent=isSDR?'How much do you earn per activity?':'What % do you earn at each tier?';if(isSDR){$('meetingRateGroup').style.display=$('payMeeting').checked?'block':'none';$('sqlRateGroup').style.display=$('paySQL').checked?'block':'none';$('showRateGroup').style.display=$('payShow').checked?'block':'none'}}}
function onboardBack(){if(onboardStep>1){onboardStep--;updateOnboardUI()}}
async function onboardNext(){if(onboardStep===1&&!selectedRole){toast('Please select your role');return}if(onboardStep<4){onboardStep++;updateOnboardUI()}else{$('obNext').disabled=true;$('obNext').textContent='Saving...';try{if(selectedRole==='ae'){const plan={user_id:user.id,role:'ae',quarterly_goal:parseFloat($('obGoal').value)||375000,tiers:JSON.stringify([0,parseFloat($('obTh2').value)||100,parseFloat($('obTh3').value)||125,parseFloat($('obTh4').value)||150]),rates_1yr:JSON.stringify([parseFloat($('obR1a').value)||6,parseFloat($('obR1b').value)||8,parseFloat($('obR1c').value)||10,parseFloat($('obR1d').value)||12]),rates_2yr:JSON.stringify([parseFloat($('obR2a').value)||8,parseFloat($('obR2b').value)||10,parseFloat($('obR2c').value)||12,parseFloat($('obR2d').value)||14])};const{data,error}=await supabase.from('comp_plans').insert(plan).select().single();if(error){console.error('Comp plan error:',error);toast('Error saving plan: '+error.message);return}compPlan=data;compPlan.tiers=JSON.parse(compPlan.tiers);compPlan.rates_1yr=JSON.parse(compPlan.rates_1yr);compPlan.rates_2yr=JSON.parse(compPlan.rates_2yr)}else{const sdrPlan={user_id:user.id,role:'sdr',quota_period:$('obPeriod').value,activity_quota:parseFloat($('obActivityQuota').value)||15,pay_meeting:$('payMeeting').checked,pay_sql:$('paySQL').checked,pay_show:$('payShow').checked,meeting_rate:parseFloat($('obMeetingRate').value)||75,sql_rate:parseFloat($('obSQLRate').value)||150,show_rate:parseFloat($('obShowRate').value)||25};const{data,error}=await supabase.from('sdr_plans').insert(sdrPlan).select().single();if(error){console.error('SDR plan error:',error);toast('Error saving plan: '+error.message);return}sdrPlan.id=data.id;window.sdrPlan=data}const{error:profileError}=await supabase.from('profiles').update({onboarded:true,role:selectedRole}).eq('id',user.id);if(profileError){console.error('Profile update error:',profileError)}if(selectedRole==='ae'){showDashboard()}else{showSDRDashboard()}toast('Setup complete!')}finally{$('obNext').disabled=false;$('obNext').textContent='Finish Setup'}}}
function showDashboard(){$('onboarding').classList.add('hidden');$('dashboard').classList.remove('hidden');$('sdrDashboard').classList.add('hidden');$('profilePage').classList.add('hidden');$('feedbackBtn').classList.remove('hidden');$('userEmail').textContent=user.email;initYear();$('quarterSelect').value=curQ();render();checkTrialStatus()}
function showSDRDashboard(){$('onboarding').classList.add('hidden');$('dashboard').classList.add('hidden');$('sdrDashboard').classList.remove('hidden');$('profilePage').classList.add('hidden');$('feedbackBtn').classList.remove('hidden');$('sdrUserEmail').textContent=user.email;initSDRMonths();renderSDR();checkTrialStatus()}
let sdrActivities=[];
function initSDRMonths(){const sel=$('sdrMonthSelect');sel.innerHTML='';const now=new Date();for(let i=0;i<6;i++){const d=new Date(now.getFullYear(),now.getMonth()-i,1);const val=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;const label=d.toLocaleDateString('en-US',{month:'long',year:'numeric'});sel.innerHTML+=`<option value="${val}">${label}</option>`}}
function renderSDR(){const plan=window.sdrPlan;if(!plan)return;const period=$('sdrMonthSelect').value;const[year,month]=period.split('-').map(Number);const activities=sdrActivities.filter(a=>{const d=new Date(a.activity_date);return d.getFullYear()===year&&d.getMonth()+1===month});const meetings=activities.filter(a=>a.type==='meeting');const sqls=activities.filter(a=>a.type==='sql');const shows=activities.filter(a=>a.type==='show');const meetingPay=meetings.length*(plan.meeting_rate||75);const sqlPay=sqls.length*(plan.sql_rate||150);const showPay=shows.length*(plan.show_rate||25);const total=meetingPay+sqlPay+showPay;const quota=plan.activity_quota||15;const completed=meetings.length;const pct=Math.round((completed/quota)*100);$('sdrQuota').textContent=quota;$('sdrPeriodLabel').textContent=plan.quota_period==='quarterly'?'meetings this quarter':'meetings this month';$('sdrCompleted').textContent=completed;$('sdrCompletedPct').textContent=pct+'% of quota';$('sdrToQuota').textContent=Math.max(0,quota-completed);$('sdrEarnings').textContent='$'+total.toLocaleString();$('sdrDoneCount').textContent=completed;$('sdrLeftCount').textContent=Math.max(0,quota-completed);$('sdrProgressBar').style.width=Math.min(175,pct)+'%';$('meetingEarnings').textContent='$'+meetingPay.toLocaleString();$('meetingCount').textContent=meetings.length;if(plan.pay_sql){$('sqlEarningsRow').style.display='flex';$('sqlCountRow').style.display='flex';$('sqlEarnings').textContent='$'+sqlPay.toLocaleString();$('sqlCount').textContent=sqls.length}if(plan.pay_show){$('showEarningsRow').style.display='flex';$('showCountRow').style.display='flex';$('showEarnings').textContent='$'+showPay.toLocaleString();$('showCount').textContent=shows.length}$('sdrTotalEarnings').textContent='$'+total.toLocaleString();renderSDRActivities()}
function renderSDRActivities(){const filter=$('sdrActivityFilter').value;const period=$('sdrMonthSelect').value;const[year,month]=period.split('-').map(Number);let list=sdrActivities.filter(a=>{const d=new Date(a.activity_date);return d.getFullYear()===year&&d.getMonth()+1===month});if(filter!=='all')list=list.filter(a=>a.type===filter);const body=$('sdrActivitiesBody');if(!list.length){body.innerHTML='';$('emptyActivities').style.display='block';return}$('emptyActivities').style.display='none';body.innerHTML=list.sort((a,b)=>new Date(b.activity_date)-new Date(a.activity_date)).map(a=>`<tr><td>${a.type==='meeting'?'üìÖ Meeting':a.type==='sql'?'üéØ SQL':'‚úÖ Show'}</td><td>${a.description||'-'}</td><td>${new Date(a.activity_date).toLocaleDateString()}</td><td class="green">$${a.payout}</td><td><button class="btn btn-ghost" onclick="deleteActivity('${a.id}')">üóëÔ∏è</button></td></tr>`).join('')}
function openActivity(){$('activityModal').classList.add('active');$('activityDesc').value='';$('activityDate').value=new Date().toISOString().split('T')[0];updateActivityForm()}
function closeActivity(){$('activityModal').classList.remove('active')}
function updateActivityForm(){const type=$('activityType').value;const plan=window.sdrPlan||{};let rate=75;if(type==='meeting')rate=plan.meeting_rate||75;else if(type==='sql')rate=plan.sql_rate||150;else if(type==='show')rate=plan.show_rate||25;$('activityPayout').textContent='$'+rate}
async function saveActivity(){const type=$('activityType').value;const desc=$('activityDesc').value;const date=$('activityDate').value;const plan=window.sdrPlan||{};let payout=75;if(type==='meeting')payout=plan.meeting_rate||75;else if(type==='sql')payout=plan.sql_rate||150;else if(type==='show')payout=plan.show_rate||25;const{data,error}=await supabase.from('sdr_activities').insert({user_id:user.id,type,description:desc,activity_date:date,payout}).select().single();if(error){toast('Error: '+error.message);return}sdrActivities.push(data);closeActivity();renderSDR();toast('Activity logged!')}
async function deleteActivity(id){if(!confirm('Delete this activity?'))return;await supabase.from('sdr_activities').delete().eq('id',id);sdrActivities=sdrActivities.filter(a=>a.id!==id);renderSDR();toast('Activity deleted')}
function openSDRSettings(){const plan=window.sdrPlan||{};$('sdrSetQuota').value=plan.activity_quota||15;$('sdrSetMeetingRate').value=plan.meeting_rate||75;$('sdrSetSQLRate').value=plan.sql_rate||150;$('sdrSetShowRate').value=plan.show_rate||25;setSDRPeriod(plan.quota_period||'monthly');$('sdrSettingsModal').classList.add('active')}
function closeSDRSettings(){$('sdrSettingsModal').classList.remove('active')}
function setSDRPeriod(p){$('sdrSetMonthly').style.borderColor=p==='monthly'?'var(--accent)':'var(--border)';$('sdrSetMonthly').style.background=p==='monthly'?'rgba(0,255,136,0.1)':'transparent';$('sdrSetMonthly').style.color=p==='monthly'?'var(--accent)':'var(--text2)';$('sdrSetQuarterly').style.borderColor=p==='quarterly'?'var(--accent)':'var(--border)';$('sdrSetQuarterly').style.background=p==='quarterly'?'rgba(0,255,136,0.1)':'transparent';$('sdrSetQuarterly').style.color=p==='quarterly'?'var(--accent)':'var(--text2)';window.sdrSettingsPeriod=p}
async function saveSDRSettings(){const updates={quota_period:window.sdrSettingsPeriod||'monthly',activity_quota:parseFloat($('sdrSetQuota').value)||15,meeting_rate:parseFloat($('sdrSetMeetingRate').value)||75,sql_rate:parseFloat($('sdrSetSQLRate').value)||150,show_rate:parseFloat($('sdrSetShowRate').value)||25};const{error}=await supabase.from('sdr_plans').update(updates).eq('id',window.sdrPlan.id);if(error){toast('Error: '+error.message);return}Object.assign(window.sdrPlan,updates);closeSDRSettings();renderSDR();toast('Settings saved!')}
async function checkTrialStatus(){const{data:profile}=await supabase.from('profiles').select('subscription_status,trial_ends_at').eq('id',user.id).single();if(!profile)return;userProfile=profile;const status=profile.subscription_status||'trial';if(status==='active')return;const trialEnd=profile.trial_ends_at?new Date(profile.trial_ends_at):null;const now=new Date();if(trialEnd&&now>trialEnd){$('trialExpiredModal').classList.remove('hidden')}}
let currentView='quarter';
function setView(v){currentView=v;document.querySelectorAll('.view-toggle button').forEach(b=>b.classList.remove('active'));document.querySelector(`.view-toggle button:${v==='quarter'?'first':'last'}-child`).classList.add('active');$('quarterView').classList.toggle('hidden',v!=='quarter');$('yearView').classList.toggle('hidden',v!=='year');$('quarterSelect').style.display=v==='quarter'?'block':'none';if(v==='year')renderYearView()}
function renderYearView(){const y=+$('yearSelect').value;const yearDeals=deals.filter(d=>d.close_date&&getY(d.close_date)===y);const months=[0,1,2,3,4,5,6,7,8,9,10,11];const monthData=months.map(m=>{const mDeals=yearDeals.filter(d=>getM(d.close_date)===m);const rev=mDeals.reduce((s,d)=>s+d.amount,0);const comm=calcMonthComm(mDeals,m,y);return{month:m,deals:mDeals.length,revenue:rev,commission:comm}});const totalRev=monthData.reduce((s,m)=>s+m.revenue,0);const totalComm=monthData.reduce((s,m)=>s+m.commission,0);const totalDeals=monthData.reduce((s,m)=>s+m.deals,0);const bestMonth=monthData.reduce((best,m)=>m.revenue>best.revenue?m:best,{revenue:0});const avgRev=totalRev/12;$('yearlySummary').innerHTML=`<div class="yearly-card highlight"><div class="yearly-card-label">Total Revenue</div><div class="yearly-card-value">${fmt(totalRev)}</div><div class="yearly-card-sub">${totalDeals} deals closed</div></div><div class="yearly-card highlight"><div class="yearly-card-label">Total Commission</div><div class="yearly-card-value green">${fmt(totalComm)}</div><div class="yearly-card-sub">YTD earnings</div></div><div class="yearly-card"><div class="yearly-card-label">Monthly Average</div><div class="yearly-card-value">${fmt(avgRev)}</div><div class="yearly-card-sub">revenue per month</div></div><div class="yearly-card"><div class="yearly-card-label">Best Month</div><div class="yearly-card-value">${bestMonth.revenue>0?mName(bestMonth.month):'N/A'}</div><div class="yearly-card-sub">${bestMonth.revenue>0?fmt(bestMonth.revenue):''}</div></div>`;const maxRev=Math.max(...monthData.map(m=>m.revenue),1);const maxComm=Math.max(...monthData.map(m=>m.commission),1);$('barChart').innerHTML=monthData.map(m=>`<div class="bar-group"><div class="bar-container"><div class="bar revenue" style="height:${(m.revenue/maxRev)*100}%"><div class="bar-tooltip">${fmt(m.revenue)}</div></div><div class="bar commission" style="height:${(m.commission/maxComm)*100}%"><div class="bar-tooltip">${fmt(m.commission)}</div></div></div><div class="bar-label">${mName(m.month).slice(0,3)}</div></div>`).join('');const quarters=['Q1','Q2','Q3','Q4'];const qData=quarters.map((q,i)=>{const qMonths=[i*3,i*3+1,i*3+2];const qDeals=yearDeals.filter(d=>qMonths.includes(getM(d.close_date)));const rev=qDeals.reduce((s,d)=>s+d.amount,0);const sp=startingPoints[y+'-'+q]||0;const comm=calcComm(qDeals,sp).total;return{q,revenue:rev,commission:comm,deals:qDeals.length}});const curQuarter=curQ();$('quarterCompare').innerHTML=qData.map(qd=>`<div class="quarter-card ${qd.q===curQuarter?'active':''}"><div class="quarter-name">${qd.q} ${y}</div><div class="quarter-revenue">${fmt(qd.revenue)}</div><div class="quarter-commission">${fmt(qd.commission)}</div><div class="quarter-deals">${qd.deals} deals</div></div>`).join('');const curMonth=curM();$('monthlyGrid').innerHTML=monthData.map(m=>`<div class="month-card ${m.month===curMonth&&y===curY()?'current':''}"><div class="month-card-header"><span class="month-name">${mName(m.month)}</span>${m.month===curMonth&&y===curY()?'<span class="month-badge">Current</span>':''}</div><div class="month-stat"><span class="month-stat-label">Revenue</span><span class="month-stat-value">${fmt(m.revenue)}</span></div><div class="month-stat"><span class="month-stat-label">Commission</span><span class="month-stat-value green">${fmt(m.commission)}</span></div><div class="month-stat"><span class="month-stat-label">Deals</span><span class="month-stat-value">${m.deals}</span></div></div>`).join('')}
function calcMonthComm(mDeals,month,year){const q=month<3?'Q1':month<6?'Q2':month<9?'Q3':'Q4';const y=year;const allQDeals=deals.filter(d=>d.close_date&&getY(d.close_date)===y&&getQ(d.close_date)===q);const dealsBeforeMonth=allQDeals.filter(d=>getM(d.close_date)<month);const sp=startingPoints[y+'-'+q]||0;const revBefore=sp+dealsBeforeMonth.reduce((s,d)=>s+d.amount,0);const revAfter=revBefore+mDeals.reduce((s,d)=>s+d.amount,0);const commBefore=calcCommAtRev(revBefore);const commAfter=calcCommAtRev(revAfter);return commAfter-commBefore}
function calcCommAtRev(rev){if(!compPlan)return 0;const goal=compPlan.quarterly_goal,tiers=compPlan.tiers,r1=compPlan.rates_1yr,r2=compPlan.rates_2yr;let comm=0;for(let i=0;i<tiers.length;i++){const tS=tiers[i]/100*goal,tE=i<tiers.length-1?tiers[i+1]/100*goal:Infinity;const revIn=Math.max(0,Math.min(rev,tE)-tS);if(revIn<=0)continue;const avgR=(r1[i]+r2[i])/2;comm+=revIn*avgR/100}return comm}
let userProfile=null;
function showProfile(){$('dashboard').classList.add('hidden');$('sdrDashboard').classList.add('hidden');$('profilePage').classList.remove('hidden');$('profileEmail').textContent=user.email;$('profileUserEmail').textContent=user.email;const role=userProfile?.role||'ae';$('profileRole').textContent=role==='sdr'?'SDR / BDR':'AE / Closer';if(role==='sdr'){const plan=window.sdrPlan||{};$('profileQuotaLabel').textContent=plan.quota_period==='quarterly'?'Quarterly Quota':'Monthly Quota';$('profileQuota').textContent=(plan.activity_quota||15)+' activities'}else{$('profileQuotaLabel').textContent='Quarterly Quota';$('profileQuota').textContent='$'+(compPlan?.quarterly_goal||375000).toLocaleString()}updateSubscriptionUI()}
function hideProfile(){$('profilePage').classList.add('hidden');if(userProfile?.role==='sdr'){showSDRDashboard()}else{showDashboard()}}
let compSettingsRole='ae';let compSettingsPeriod='monthly';
function openCompSettings(){const role=userProfile?.role||'ae';compSettingsRole=role;setCompRole(role);if(role==='ae'&&compPlan){$('compQuota').value=compPlan.quarterly_goal||375000;$('compTh2').value=compPlan.tiers?.[1]||100;$('compTh3').value=compPlan.tiers?.[2]||125;$('compTh4').value=compPlan.tiers?.[3]||150;$('compR1a').value=compPlan.rates_1yr?.[0]||6;$('compR1b').value=compPlan.rates_1yr?.[1]||8;$('compR1c').value=compPlan.rates_1yr?.[2]||10;$('compR1d').value=compPlan.rates_1yr?.[3]||12;$('compR2a').value=compPlan.rates_2yr?.[0]||8;$('compR2b').value=compPlan.rates_2yr?.[1]||10;$('compR2c').value=compPlan.rates_2yr?.[2]||12;$('compR2d').value=compPlan.rates_2yr?.[3]||14}else if(role==='sdr'&&window.sdrPlan){const plan=window.sdrPlan;compSettingsPeriod=plan.quota_period||'monthly';setCompPeriod(compSettingsPeriod);$('compActivityQuota').value=plan.activity_quota||15;$('compMeetingRate').value=plan.meeting_rate||75;$('compSQLRate').value=plan.sql_rate||150;$('compShowRate').value=plan.show_rate||25}$('compSettingsModal').classList.add('active')}
function closeCompSettings(){$('compSettingsModal').classList.remove('active')}
function setCompRole(r){compSettingsRole=r;$('compRoleAE').style.border=r==='ae'?'1px solid var(--accent)':'1px solid var(--border)';$('compRoleAE').style.background=r==='ae'?'rgba(0,255,136,0.1)':'transparent';$('compRoleAE').style.color=r==='ae'?'var(--accent)':'var(--text2)';$('compRoleSDR').style.border=r==='sdr'?'1px solid var(--accent)':'1px solid var(--border)';$('compRoleSDR').style.background=r==='sdr'?'rgba(0,255,136,0.1)':'transparent';$('compRoleSDR').style.color=r==='sdr'?'var(--accent)':'var(--text2)';$('aeSettingsFields').style.display=r==='ae'?'block':'none';$('sdrSettingsFields').style.display=r==='sdr'?'block':'none'}
function setCompPeriod(p){compSettingsPeriod=p;$('compMonthly').style.border=p==='monthly'?'1px solid var(--accent)':'1px solid var(--border)';$('compMonthly').style.background=p==='monthly'?'rgba(0,255,136,0.1)':'transparent';$('compMonthly').style.color=p==='monthly'?'var(--accent)':'var(--text2)';$('compQuarterly').style.border=p==='quarterly'?'1px solid var(--accent)':'1px solid var(--border)';$('compQuarterly').style.background=p==='quarterly'?'rgba(0,255,136,0.1)':'transparent';$('compQuarterly').style.color=p==='quarterly'?'var(--accent)':'var(--text2)'}
async function saveCompSettings(){const oldRole=userProfile?.role||'ae';const newRole=compSettingsRole;if(newRole==='ae'){const updates={quarterly_goal:parseFloat($('compQuota').value)||375000,tiers:JSON.stringify([0,parseFloat($('compTh2').value)||100,parseFloat($('compTh3').value)||125,parseFloat($('compTh4').value)||150]),rates_1yr:JSON.stringify([parseFloat($('compR1a').value)||6,parseFloat($('compR1b').value)||8,parseFloat($('compR1c').value)||10,parseFloat($('compR1d').value)||12]),rates_2yr:JSON.stringify([parseFloat($('compR2a').value)||8,parseFloat($('compR2b').value)||10,parseFloat($('compR2c').value)||12,parseFloat($('compR2d').value)||14])};if(oldRole==='ae'&&compPlan){await supabase.from('comp_plans').update(updates).eq('id',compPlan.id);Object.assign(compPlan,{...updates,tiers:JSON.parse(updates.tiers),rates_1yr:JSON.parse(updates.rates_1yr),rates_2yr:JSON.parse(updates.rates_2yr)})}else{updates.user_id=user.id;updates.role='ae';const{data}=await supabase.from('comp_plans').insert(updates).select().single();compPlan=data;compPlan.tiers=JSON.parse(compPlan.tiers);compPlan.rates_1yr=JSON.parse(compPlan.rates_1yr);compPlan.rates_2yr=JSON.parse(compPlan.rates_2yr)}}else{const updates={quota_period:compSettingsPeriod,activity_quota:parseFloat($('compActivityQuota').value)||15,meeting_rate:parseFloat($('compMeetingRate').value)||75,sql_rate:parseFloat($('compSQLRate').value)||150,show_rate:parseFloat($('compShowRate').value)||25};if(oldRole==='sdr'&&window.sdrPlan){await supabase.from('sdr_plans').update(updates).eq('id',window.sdrPlan.id);Object.assign(window.sdrPlan,updates)}else{updates.user_id=user.id;updates.role='sdr';const{data}=await supabase.from('sdr_plans').insert(updates).select().single();window.sdrPlan=data}}if(oldRole!==newRole){await supabase.from('profiles').update({role:newRole}).eq('id',user.id);userProfile.role=newRole}closeCompSettings();showProfile();toast('Settings saved!')}
async function updateSubscriptionUI(){if(!userProfile){const{data}=await supabase.from('profiles').select('*').eq('id',user.id).single();userProfile=data}const status=userProfile?.subscription_status||'trial';const trialEnd=userProfile?.trial_ends_at?new Date(userProfile.trial_ends_at):new Date(Date.now()+14*24*60*60*1000);const now=new Date();const daysLeft=Math.max(0,Math.ceil((trialEnd-now)/(1000*60*60*24)));const statusEl=$('subStatus');const trialBanner=$('trialBanner');const renewalRow=$('renewalRow');const manageRow=$('manageSubRow');if(status==='active'){statusEl.textContent='Active';statusEl.className='subscription-badge active';trialBanner.style.display='none';renewalRow.style.display='flex';manageRow.style.display='flex';$('renewalDate').textContent=userProfile.current_period_end?new Date(userProfile.current_period_end).toLocaleDateString():'‚Äî'}else if(status==='canceled'){statusEl.textContent='Canceled';statusEl.className='subscription-badge expired';trialBanner.style.display='none';renewalRow.style.display='none';manageRow.style.display='none'}else if(daysLeft<=0){statusEl.textContent='Trial Expired';statusEl.className='subscription-badge expired';$('trialDaysLeft').textContent='Your free trial has ended';trialBanner.style.display='flex';renewalRow.style.display='none';manageRow.style.display='none'}else{statusEl.textContent='Free Trial';statusEl.className='subscription-badge trial';$('trialDaysLeft').textContent=`${daysLeft} day${daysLeft!==1?'s':''} left in your free trial`;trialBanner.style.display='flex';renewalRow.style.display='none';manageRow.style.display='none'}}
function subscribe(){window.location.href='https://buy.stripe.com/6oU3cofdqgwk0gm7D79oc00'}
function manageSubscription(){window.open('https://billing.stripe.com/p/login/YOUR_PORTAL_LINK','_blank')}
function showChangePassword(){$('passwordModal').classList.add('active');$('newPassword').value='';$('confirmPassword').value='';$('passwordError').classList.remove('show')}
function hideChangePassword(){$('passwordModal').classList.remove('active')}
async function changePassword(e){e.preventDefault();const newPw=$('newPassword').value;const confirmPw=$('confirmPassword').value;if(newPw!==confirmPw){$('passwordError').textContent='Passwords do not match';$('passwordError').classList.add('show');return}const{error}=await supabase.auth.updateUser({password:newPw});if(error){$('passwordError').textContent=error.message;$('passwordError').classList.add('show');return}hideChangePassword();toast('Password updated')}
async function deleteAccount(){if(!confirm('Are you sure? This will permanently delete all your data.'))return;if(!confirm('This cannot be undone. Type DELETE to confirm.')&&prompt('Type DELETE to confirm')!=='DELETE')return;await supabase.from('deals').delete().eq('user_id',user.id);await supabase.from('comp_plans').delete().eq('user_id',user.id);await supabase.from('starting_points').delete().eq('user_id',user.id);await supabase.from('profiles').delete().eq('id',user.id);await supabase.auth.signOut();toast('Account deleted');user=null;compPlan=null;deals=[];$('app').style.display='none';$('landing').style.display='block'}
function showFeedback(){$('feedbackModal').classList.add('active');$('feedbackText').value='';$('feedbackEmail').value=user?.email||''}
function hideFeedback(){$('feedbackModal').classList.remove('active')}
function setFeedbackType(btn,type){document.querySelectorAll('.feedback-type button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');$('feedbackType').value=type}
async function submitFeedback(){const type=$('feedbackType').value;const text=$('feedbackText').value.trim();const email=$('feedbackEmail').value.trim()||user?.email||'';if(!text){toast('Please enter your feedback');return}const{error}=await supabase.from('feedback').insert({type,message:text,email,user_id:user?.id||null});if(error){window.location.href=`mailto:info@comish.online?subject=${encodeURIComponent(type.toUpperCase()+': Feedback')}&body=${encodeURIComponent(text+'\\n\\nFrom: '+email)}`;hideFeedback();toast('Thanks for your feedback!');return}hideFeedback();toast('Thanks! Your feedback has been sent.')}
function setLandingFeedbackType(btn,type){btn.parentElement.querySelectorAll('button').forEach(b=>{b.style.borderColor='var(--border)';b.style.background='transparent';b.style.color='var(--text2)';b.style.fontWeight='500'});btn.style.borderColor='var(--accent)';btn.style.background='rgba(0,255,136,0.1)';btn.style.color='var(--accent)';btn.style.fontWeight='600';$('landingFeedbackType').value=type}
async function submitLandingFeedback(){const type=$('landingFeedbackType').value;const text=$('landingFeedbackText').value.trim();const email=$('landingFeedbackEmail').value.trim();if(!text){toast('Please enter your feedback');return}try{const{error}=await supabase.from('feedback').insert({type,message:text,email:email||null,user_id:null});if(error)throw error;$('landingFeedbackText').value='';$('landingFeedbackEmail').value='';toast('Thanks! Your feedback has been sent.')}catch(e){window.location.href=`mailto:info@comish.online?subject=${encodeURIComponent(type.toUpperCase()+': Feedback')}&body=${encodeURIComponent(text+'\\n\\nFrom: '+email)}`;toast('Thanks for your feedback!')}}
function curQ(){const m=new Date().getMonth();return m<3?'Q1':m<6?'Q2':m<9?'Q3':'Q4'}
function curY(){return new Date().getFullYear()}
function curM(){return new Date().getMonth()}
function getQ(d){const m=new Date(d+'T00:00:00').getMonth();return m<3?'Q1':m<6?'Q2':m<9?'Q3':'Q4'}
function getM(d){return new Date(d+'T00:00:00').getMonth()}
function getY(d){return new Date(d+'T00:00:00').getFullYear()}
function fmtD(d){return new Date(d+'T00:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric'})}
function qKey(){return $('yearSelect').value+'-'+$('quarterSelect').value}
function qMonths(q){return q==='Q1'?[0,1,2]:q==='Q2'?[3,4,5]:q==='Q3'?[6,7,8]:[9,10,11]}
function mName(m){return['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][m]}
function initYear(){const s=$('yearSelect'),y=new Set([curY()]);deals.forEach(d=>{if(d.close_date)y.add(getY(d.close_date))});s.innerHTML=[...y].sort((a,b)=>b-a).map(yr=>`<option>${yr}</option>`).join('')}
async function saveStarting(){const k=qKey(),a=parseFloat($('startingPoint').value)||0;startingPoints[k]=a;await supabase.from('starting_points').upsert({user_id:user.id,comp_plan_id:compPlan.id,quarter:k,amount:a},{onConflict:'user_id,comp_plan_id,quarter'});render()}
function filtered(){const y=+$('yearSelect').value,q=$('quarterSelect').value;return deals.filter(d=>d.close_date&&getY(d.close_date)===y&&getQ(d.close_date)===q)}
function calcComm(deals,start){const goal=compPlan.quarterly_goal,tiers=compPlan.tiers,r1=compPlan.rates_1yr,r2=compPlan.rates_2yr,total=start+deals.reduce((s,d)=>s+d.amount,0),y1=deals.filter(d=>d.term===1),y2=deals.filter(d=>d.term===2),y1Tot=y1.reduce((s,d)=>s+d.amount,0),y2Tot=y2.reduce((s,d)=>s+d.amount,0),dTot=y1Tot+y2Tot,tierData=[];let y1C=0,y2C=0;for(let i=0;i<tiers.length;i++){const tS=tiers[i]/100*goal,tE=i<tiers.length-1?tiers[i+1]/100*goal:Infinity,revIn=Math.max(0,Math.min(total,tE)-tS);if(revIn<=0){tierData.push({tier:i+1,rev:0,comm:0,start:tS,end:tE});continue}const startIn=Math.max(0,Math.min(start,tE)-tS),dealsIn=revIn-startIn;let y1In=0,y2In=0;if(dTot>0&&dealsIn>0){y1In=dealsIn*(y1Tot/dTot);y2In=dealsIn*(y2Tot/dTot)}const y1Cm=y1In*r1[i]/100,y2Cm=y2In*r2[i]/100,avgR=(r1[i]+r2[i])/2,startCm=startIn*avgR/100;y1C+=y1Cm;y2C+=y2Cm;tierData.push({tier:i+1,rev:revIn,y1:y1In,y2:y2In,comm:y1Cm+y2Cm+startCm,start:tS,end:tE})}return{y1C,y2C,total:tierData.reduce((s,t)=>s+t.comm,0),tierData,y1Tot,y2Tot}}
function render(){const goal=compPlan.quarterly_goal,tiers=compPlan.tiers,r1=compPlan.rates_1yr,r2=compPlan.rates_2yr,start=startingPoints[qKey()]||0;$('startingPoint').value=start||'';const d=filtered(),dTot=d.reduce((s,x)=>s+x.amount,0),qtd=start+dTot,pct=qtd/goal*100;let tier=0;for(let i=tiers.length-1;i>=0;i--)if(pct>=tiers[i]){tier=i;break}const c=calcComm(d,start);$('qtdTotal').textContent=fmt(qtd);$('qGoal').textContent=fmt(goal);$('attainmentPct').textContent=pct.toFixed(1)+'%';$('currentTier').textContent='Tier '+(tier+1);$('tierRates').textContent=`1yr: ${r1[tier]}% ¬∑ 2yr: ${r2[tier]}%`;const nx=tier+1;if(nx<tiers.length){$('toNext').textContent=fmt(Math.max(0,tiers[nx]/100*goal-qtd));$('nextTierName').textContent='to Tier '+(nx+1)}else{$('toNext').textContent='Max!';$('nextTierName').textContent=''}const mD=d.filter(x=>getM(x.close_date)===curM()&&getY(x.close_date)===curY());$('monthTotal').textContent=fmt(mD.reduce((s,x)=>s+x.amount,0));$('monthDeals').textContent=mD.length+' deal'+(mD.length!==1?'s':'');$('progressBar').style.width=Math.min(100,pct/175*100)+'%';$('closedAmt').textContent=fmt(qtd);$('remainingAmt').textContent=fmt(Math.max(0,goal-qtd));let bH='';for(const t of c.tierData){const a=t.rev>0,eD=t.end===Infinity?'‚àû':fmt(t.end);bH+=`<div class="tier-row ${a?'active':''}"><span class="tier-color" style="background:var(--${['blue','purple','pink','orange'][t.tier-1]})"></span><div class="tier-info"><div class="tier-name">Tier ${t.tier} (${r1[t.tier-1]}%/${r2[t.tier-1]}%)</div><div class="tier-range">${fmt(t.start)} to ${eD}</div></div><div class="tier-amounts"><div class="tier-rev">${fmt(t.rev)}</div><div class="tier-comm">${fmt(t.comm)}</div></div></div>`}$('tierBreakdown').innerHTML=bH;$('y1Comm').textContent=fmt(c.y1C);$('y2Comm').textContent=fmt(c.y2C);$('totalComm').textContent=fmt(c.total);$('totalCommStat').textContent=fmt(c.total);$('y1Rev').textContent=fmt(c.y1Tot);$('y2Rev').textContent=fmt(c.y2Tot);$('totalRev').textContent=fmt(dTot);const qM=qMonths($('quarterSelect').value),mf=$('monthFilter'),cv=mf.value;mf.innerHTML='<option value="all">All Months</option>'+qM.map(m=>`<option value="${m}">${mName(m)}</option>`).join('');mf.value=cv;renderDeals()}
function renderDeals(){let d=filtered();const mf=$('monthFilter').value;if(mf!=='all')d=d.filter(x=>getM(x.close_date)===+mf);d.sort((a,b)=>new Date(b.close_date)-new Date(a.close_date));const tb=$('dealsBody'),em=$('emptyDeals');if(!d.length){tb.innerHTML='';em.style.display='block';return}em.style.display='none';tb.innerHTML=d.map(x=>`<tr><td style="font-weight:500">${x.name}</td><td style="font-weight:600">${fmt(x.amount)}</td><td><span class="badge ${x.term===2?'y2':'y1'}">${x.term}yr</span></td><td style="color:var(--text2)">${fmtD(x.close_date)}</td><td><span class="badge ${x.paid?'paid':'unpaid'}">${x.paid?'Paid':'Unpaid'}</span></td><td class="deal-actions">${!x.paid?`<button onclick="markPaid('${x.id}')">üí∞</button>`:''}<button onclick="editDeal('${x.id}')">‚úé</button><button onclick="delDeal('${x.id}')">√ó</button></td></tr>`).join('')}
function setTerm(t){$('dealTerm').value=t;document.querySelectorAll('.toggle-opt.y1,.toggle-opt.y2').forEach(e=>e.classList.remove('active'));document.querySelector(`.toggle-opt.y${t}`).classList.add('active')}
function setPaid(p){$('dealPaid').value=p;$('paidOpt').classList.toggle('active',p);$('unpaidOpt').classList.toggle('active',!p)}
function openDeal(id){$('dealModal').classList.add('active');$('dealModalTitle').textContent=id?'Edit Deal':'Add Deal';$('editId').value=id||'';if(id){const d=deals.find(x=>x.id===id);if(d){$('dealName').value=d.name;$('dealAmt').value=d.amount;$('dealDate').value=d.close_date;setTerm(d.term||1);setPaid(d.paid||false)}}else{$('dealName').value='';$('dealAmt').value='';$('dealDate').value=new Date().toISOString().split('T')[0];setTerm(1);setPaid(false)}}
function closeDeal(){$('dealModal').classList.remove('active')}
async function saveDeal(){const n=$('dealName').value.trim(),a=parseFloat($('dealAmt').value),dt=$('dealDate').value,tm=+$('dealTerm').value,pd=$('dealPaid').value==='true',eid=$('editId').value;if(!n||isNaN(a)||!dt){toast('Fill all fields');return}if(eid){const{error}=await supabase.from('deals').update({name:n,amount:a,close_date:dt,term:tm,paid:pd}).eq('id',eid);if(error){toast('Error: '+error.message);return}const d=deals.find(x=>x.id===eid);if(d){d.name=n;d.amount=a;d.close_date=dt;d.term=tm;d.paid=pd}toast('Updated')}else{const{data,error}=await supabase.from('deals').insert({user_id:user.id,comp_plan_id:compPlan.id,name:n,amount:a,close_date:dt,term:tm,paid:pd}).select().single();if(error){toast('Error: '+error.message);return}deals.push(data);toast('Deal added')}closeDeal();initYear();render()}
function editDeal(id){openDeal(id)}
async function delDeal(id){if(!confirm('Delete this deal?'))return;const{error}=await supabase.from('deals').delete().eq('id',id);if(error){toast('Error: '+error.message);return}deals=deals.filter(d=>d.id!==id);render();toast('Deleted')}
async function markPaid(id){const{error}=await supabase.from('deals').update({paid:true}).eq('id',id);if(error){toast('Error: '+error.message);return}const d=deals.find(x=>x.id===id);if(d)d.paid=true;render();toast('Marked paid')}
function openSettings(){$('settingsModal').classList.add('active');$('setGoal').value=compPlan.quarterly_goal;$('setTh2').value=compPlan.tiers[1];$('setTh3').value=compPlan.tiers[2];$('setTh4').value=compPlan.tiers[3];$('setR1a').value=compPlan.rates_1yr[0];$('setR1b').value=compPlan.rates_1yr[1];$('setR1c').value=compPlan.rates_1yr[2];$('setR1d').value=compPlan.rates_1yr[3];$('setR2a').value=compPlan.rates_2yr[0];$('setR2b').value=compPlan.rates_2yr[1];$('setR2c').value=compPlan.rates_2yr[2];$('setR2d').value=compPlan.rates_2yr[3]}
function closeSettings(){$('settingsModal').classList.remove('active')}
async function saveSettings(){const u={quarterly_goal:+$('setGoal').value||375000,tiers:JSON.stringify([0,+$('setTh2').value||100,+$('setTh3').value||125,+$('setTh4').value||150]),rates_1yr:JSON.stringify([+$('setR1a').value||6,+$('setR1b').value||8,+$('setR1c').value||10,+$('setR1d').value||12]),rates_2yr:JSON.stringify([+$('setR2a').value||8,+$('setR2b').value||10,+$('setR2c').value||12,+$('setR2d').value||14])};const{error}=await supabase.from('comp_plans').update(u).eq('id',compPlan.id);if(error){toast('Error: '+error.message);return}compPlan.quarterly_goal=u.quarterly_goal;compPlan.tiers=JSON.parse(u.tiers);compPlan.rates_1yr=JSON.parse(u.rates_1yr);compPlan.rates_2yr=JSON.parse(u.rates_2yr);closeSettings();render();toast('Settings saved')}
function exportCSV(){if(!deals.length){toast('No deals to export');return}let c='Name,Amount,Date,Term,Paid\n';deals.forEach(d=>{c+=`"${d.name}",${d.amount},${d.close_date},${d.term}yr,${d.paid?'Y':'N'}\n`});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([c],{type:'text/csv'}));a.download='comish-deals.csv';a.click();toast('Exported')}

// Billing toggle
let billingAnnual=false;
function toggleBilling(){billingAnnual=!billingAnnual;const dot=$('billingDot');const mL=$('monthlyLabel');const yL=$('yearlyLabel');const price=$('proPrice');const period=$('proPeriod');if(billingAnnual){dot.style.left='31px';mL.style.color='var(--muted)';yL.style.color='var(--accent)';price.innerHTML='$50<span>/yr</span>';period.textContent='Billed annually. Save $10/year.'}else{dot.style.left='3px';mL.style.color='var(--accent)';yL.style.color='var(--muted)';price.innerHTML='$5<span>/mo</span>';period.textContent='Billed monthly. Cancel anytime.'}}

// Forecast calculator
function openForecast(){$('forecastModal').classList.add('active');renderForecast()}
function closeForecast(){$('forecastModal').classList.remove('active')}
function renderForecast(){const c=$('forecastContent');if(!compPlan){c.innerHTML='<p>Set up your comp plan first</p>';return}let html='<div style="margin-bottom:1.5rem"><p style="color:var(--text2);margin-bottom:1rem">Add hypothetical deals to see how they\'d affect your commission:</p><div id="forecastDeals"></div><button onclick="addForecastDeal()" style="margin-top:0.75rem;padding:0.5rem 1rem;background:var(--card2);border:1px solid var(--border);border-radius:8px;color:var(--text);cursor:pointer">+ Add Deal</button></div><div id="forecastResults" style="background:var(--card2);border-radius:12px;padding:1.5rem;margin-top:1rem"></div>';c.innerHTML=html;window.forecastDeals=[];addForecastDeal();calcForecast()}
function addForecastDeal(){const id=Date.now();window.forecastDeals.push({id,amount:0,term:1});const d=document.createElement('div');d.id='fd-'+id;d.style='display:grid;grid-template-columns:1fr 80px 30px;gap:0.5rem;margin-bottom:0.5rem;align-items:center';d.innerHTML='<input type="number" placeholder="Deal amount" onchange="updateForecastDeal('+id+',this.value)" style="padding:0.625rem;background:var(--card);border:1px solid var(--border);border-radius:8px;color:var(--text);width:100%"><select onchange="updateForecastTerm('+id+',this.value)" style="padding:0.625rem;background:var(--card);border:1px solid var(--border);border-radius:8px;color:var(--text)"><option value="1">1yr</option><option value="2">2yr</option></select><span onclick="removeForecastDeal('+id+')" style="cursor:pointer;color:var(--muted);text-align:center">√ó</span>';$('forecastDeals').appendChild(d)}
function updateForecastDeal(id,v){const d=window.forecastDeals.find(x=>x.id===id);if(d)d.amount=parseFloat(v)||0;calcForecast()}
function updateForecastTerm(id,v){const d=window.forecastDeals.find(x=>x.id===id);if(d)d.term=parseInt(v);calcForecast()}
function removeForecastDeal(id){window.forecastDeals=window.forecastDeals.filter(x=>x.id!==id);const el=$('fd-'+id);if(el)el.remove();calcForecast()}
function calcForecast(){const r=$('forecastResults');if(!compPlan||!window.forecastDeals){r.innerHTML='';return}const qDeals=deals.filter(d=>{const dt=new Date(d.close_date);return dt.getFullYear()===currentYear&&Math.floor(dt.getMonth()/3)===currentQtr});const currentRev=qDeals.reduce((s,d)=>s+d.amount,0);const forecastRev=window.forecastDeals.reduce((s,d)=>s+d.amount,0);const totalRev=currentRev+forecastRev;const currentComm=calcComm(qDeals);const allDeals=[...qDeals,...window.forecastDeals.map(d=>({amount:d.amount,term:d.term}))];const totalComm=calcComm(allDeals);const addedComm=totalComm-currentComm;const quota=compPlan.quarterly_goal;const currentPct=Math.round(currentRev/quota*100);const totalPct=Math.round(totalRev/quota*100);r.innerHTML='<div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem"><div><div style="font-size:0.8rem;color:var(--muted);margin-bottom:0.25rem">Current Revenue</div><div style="font-size:1.25rem;font-weight:700">$'+currentRev.toLocaleString()+'</div><div style="font-size:0.8rem;color:var(--muted)">'+currentPct+'% to quota</div></div><div><div style="font-size:0.8rem;color:var(--muted);margin-bottom:0.25rem">With Forecast</div><div style="font-size:1.25rem;font-weight:700;color:var(--accent)">$'+totalRev.toLocaleString()+'</div><div style="font-size:0.8rem;color:var(--accent)">'+totalPct+'% to quota</div></div></div><div style="height:1px;background:var(--border);margin:1rem 0"></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem"><div><div style="font-size:0.8rem;color:var(--muted);margin-bottom:0.25rem">Current Commission</div><div style="font-size:1.25rem;font-weight:700">$'+currentComm.toLocaleString()+'</div></div><div><div style="font-size:0.8rem;color:var(--muted);margin-bottom:0.25rem">With Forecast</div><div style="font-size:1.25rem;font-weight:700;color:var(--accent)">$'+totalComm.toLocaleString()+'</div></div></div>'+(addedComm>0?'<div style="margin-top:1rem;padding:1rem;background:rgba(0,255,136,0.1);border-radius:8px;text-align:center"><span style="color:var(--accent);font-weight:700;font-size:1.25rem">+$'+addedComm.toLocaleString()+'</span><span style="color:var(--text2);margin-left:0.5rem">additional commission</span></div>':'')}

// PDF Export
function exportPDF(){if(!deals.length){toast('No deals to export');return}const qDeals=deals.filter(d=>{const dt=new Date(d.close_date);return dt.getFullYear()===currentYear&&Math.floor(dt.getMonth()/3)===currentQtr});const totalRev=qDeals.reduce((s,d)=>s+d.amount,0);const totalComm=calcComm(qDeals);const paidDeals=qDeals.filter(d=>d.paid);const paidComm=calcComm(paidDeals);const qName=['Q1','Q2','Q3','Q4'][currentQtr];const win=window.open('','_blank');win.document.write('<html><head><title>Comish Report - '+qName+' '+currentYear+'</title><style>body{font-family:system-ui,sans-serif;max-width:800px;margin:0 auto;padding:40px;color:#333}h1{color:#000;border-bottom:2px solid #00ff88;padding-bottom:10px}table{width:100%;border-collapse:collapse;margin:20px 0}th,td{padding:12px;text-align:left;border-bottom:1px solid #ddd}th{background:#f5f5f5;font-weight:600}.summary{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin:30px 0}.summary-card{background:#f9f9f9;padding:20px;border-radius:8px;text-align:center}.summary-card h3{margin:0 0 10px;color:#666;font-size:14px}.summary-card p{margin:0;font-size:24px;font-weight:700}.green{color:#00aa55}.footer{margin-top:40px;text-align:center;color:#999;font-size:12px}@media print{body{padding:20px}}</style></head><body>');win.document.write('<h1>Commission Report</h1>');win.document.write('<p><strong>Period:</strong> '+qName+' '+currentYear+'</p>');win.document.write('<p><strong>Generated:</strong> '+new Date().toLocaleDateString()+'</p>');win.document.write('<div class="summary"><div class="summary-card"><h3>Total Revenue</h3><p>$'+totalRev.toLocaleString()+'</p></div><div class="summary-card"><h3>Total Commission</h3><p class="green">$'+totalComm.toLocaleString()+'</p></div><div class="summary-card"><h3>Paid Out</h3><p>$'+paidComm.toLocaleString()+'</p></div></div>');win.document.write('<h2>Deals</h2><table><tr><th>Name</th><th>Amount</th><th>Date</th><th>Term</th><th>Paid</th></tr>');qDeals.forEach(d=>{win.document.write('<tr><td>'+d.name+'</td><td>$'+d.amount.toLocaleString()+'</td><td>'+d.close_date+'</td><td>'+d.term+'yr</td><td>'+(d.paid?'‚úì':'')+'</td></tr>')});win.document.write('</table>');win.document.write('<div class="footer">Generated by Comish - comish.online</div>');win.document.write('</body></html>');win.document.close();setTimeout(()=>win.print(),250);toast('PDF ready to print')}

async function init(){supabase=window.supabase.createClient(SUPABASE_URL,SUPABASE_KEY);const{data:{session}}=await supabase.auth.getSession();if(session)await loadUser(session.user);supabase.auth.onAuthStateChange(async(e,s)=>{if(e==='SIGNED_IN'&&s)await loadUser(s.user)})}
async function loadUser(u){user=u;$('landing').style.display='none';$('app').style.display='block';const{data:profile}=await supabase.from('profiles').select('*').eq('id',user.id).single();if(!profile||!profile.onboarded){showOnboarding();return}userProfile=profile;if(profile.role==='sdr'){const{data:plan}=await supabase.from('sdr_plans').select('*').eq('user_id',user.id).single();window.sdrPlan=plan;const{data:acts}=await supabase.from('sdr_activities').select('*').eq('user_id',user.id);sdrActivities=acts||[];showSDRDashboard()}else{const{data:plans}=await supabase.from('comp_plans').select('*').eq('user_id',user.id);if(plans&&plans.length){compPlan=plans[0];compPlan.tiers=JSON.parse(compPlan.tiers);compPlan.rates_1yr=JSON.parse(compPlan.rates_1yr);compPlan.rates_2yr=JSON.parse(compPlan.rates_2yr)}const{data:d}=await supabase.from('deals').select('*').eq('user_id',user.id);deals=d||[];const{data:sp}=await supabase.from('starting_points').select('*').eq('user_id',user.id);if(sp)sp.forEach(s=>{startingPoints[s.quarter]=s.amount});showDashboard()}}
init();

// Register service worker for PWA
if('serviceWorker' in navigator){navigator.serviceWorker.register('/sw.js').catch(()=>{})}
</script>
</body>
</html>
